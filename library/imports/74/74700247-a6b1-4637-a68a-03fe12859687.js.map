{"version":3,"sources":["assets\\start-scene\\scripts\\MainData.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// @\r\nimport { NetUtils } from './NetUtils';\r\nimport { ABTest, ItemTypeEnum } from './Constants';\r\nimport { gm } from './GameManager';\r\nimport { StorageBase } from './StorageBase';\r\nimport { ServerNoticeData } from './ServerData';\r\n\r\n//\r\nexport class MainData extends StorageBase {\r\n    // @\r\n    public static EVENT_DATA_CHANGE: string = \"main_data_change\";\r\n    // @ private\r\n    private is_music_mute: boolean;\r\n    private is_effect_mute: boolean;\r\n    private role_map_Data: MapDataVO;\r\n    public is_first_super_recruit: boolean;\r\n\r\n    // @ public\r\n    public STORAGE_KEY: string;\r\n    public uuid: string; // (public mode not used)\r\n    public new_store_timestamp: number; // (public mode not used)\r\n    public store_timestamp: number = 0; // (public mode not used)\r\n    public is_vibrate: boolean; // (public mode not used)\r\n    public ab_test: ABTest; // (public mode not used)\r\n    public has_watch_story: boolean; // (public mode not used)\r\n    public story_reward: number; // (public mode not used)\r\n    public left_share_count: number;\r\n    public is_today_no_ad: boolean;\r\n    public is_receive_shortcut_reward: boolean;\r\n    public left_free_super_recruit_count: number;\r\n    public super_recruit_count: number;\r\n    public server_notice_data: ServerNoticeData;\r\n\r\n    // @\r\n    constructor() {\r\n        super();\r\n        this.STORAGE_KEY = \"MainData\", \r\n        this.uuid = \"\";\r\n        this.new_store_timestamp = Date.now();\r\n        this.store_timestamp = 0;\r\n        //\r\n        this.is_music_mute = false;\r\n        this.is_effect_mute = false;\r\n        this.is_vibrate = false;\r\n        this.ab_test = ABTest.A;\r\n        this.has_watch_story = true;\r\n        this.story_reward = 0;\r\n        this.left_share_count = 0;\r\n        this.is_today_no_ad = false;\r\n        //\r\n        this.role_map_Data = null;\r\n        this.is_receive_shortcut_reward = false;\r\n        this.left_free_super_recruit_count = 0;\r\n        this.is_first_super_recruit = true;\r\n        this.super_recruit_count = 0;\r\n        // this.server_notice_data = null;\r\n    }\r\n\r\n    // @\r\n    public async async_read_data(callback?: (data: any) => void): Promise<void> {\r\n        const self = this;\r\n        super.async_read_data((data) => {\r\n            if (self.is_init) {\r\n                if (self.server_notice_data === null) {\r\n                    self.server_notice_data = new ServerNoticeData();\r\n                }\r\n                self.left_share_count = self.left_share_count ?? gm.const.MAX_VIDEO_FAIL_SHARE_COUNT;\r\n                self.is_today_no_ad = self.is_today_no_ad ?? false;\r\n                self.is_receive_shortcut_reward = self.is_receive_shortcut_reward ?? false;\r\n                self.left_free_super_recruit_count = self.left_free_super_recruit_count ?? gm.const.MAX_FREE_SUPER_RECRUIT_COUNT;\r\n                self.super_recruit_count = self.super_recruit_count ?? 0;\r\n                self.is_first_super_recruit = self.is_first_super_recruit ?? true;\r\n                Object.setPrototypeOf(self.server_notice_data, ServerNoticeData.prototype);\r\n            } else {\r\n                self.uuid = NetUtils.generate_uuid();\r\n                self.ab_test = Math.floor(self.new_store_timestamp / 1000) % 2 === 0 ? ABTest.A : ABTest.B;\r\n                self.has_watch_story = false;\r\n                self.role_map_Data = new MapDataVO();\r\n                self.story_reward = 0;\r\n                self.role_map_Data.col = 0;\r\n                self.role_map_Data.row = 0;\r\n                self.role_map_Data.mapList = [];\r\n                self.server_notice_data = new ServerNoticeData();\r\n                self.left_share_count = gm.const.MAX_VIDEO_FAIL_SHARE_COUNT;\r\n                self.is_today_no_ad = false;\r\n                self.left_free_super_recruit_count = gm.const.MAX_FREE_SUPER_RECRUIT_COUNT;\r\n                self.super_recruit_count = 0;\r\n                self.is_first_super_recruit = true;\r\n                self.is_init = true;\r\n                self.async_write_data();\r\n            }\r\n            gm.audio.music_mute = self.is_music_mute;\r\n            gm.audio.music_volume = self.is_music_mute ? 0 : 1;\r\n            gm.audio.effect_mute = self.is_effect_mute;\r\n            gm.audio.effect_volume = self.is_effect_mute ? 0 : 1;\r\n            if (callback) callback(data);\r\n        });\r\n    } // end: async_read_data\r\n\r\n    // @\r\n    public async async_write_data(callback?: () => void): Promise<void> {\r\n        gm.data.event_emitter.emit(MainData.EVENT_DATA_CHANGE);\r\n        this.store_timestamp = Date.now();\r\n        this.is_music_mute = gm.audio.music_mute;\r\n        this.is_effect_mute = gm.audio.effect_mute;\r\n        super.async_write_data(callback);\r\n    }\r\n\r\n    // @\r\n    public clear(): void {\r\n        this.uuid = \"\";\r\n        this.new_store_timestamp = Date.now();\r\n        this.store_timestamp = 0;\r\n        this.is_music_mute = false;\r\n        this.is_effect_mute = false;\r\n        this.is_vibrate = false;\r\n        this.ab_test = ABTest.A;\r\n        this.has_watch_story = true;\r\n        this.story_reward = 0;\r\n        this.role_map_Data = new MapDataVO();\r\n        this.server_notice_data = new ServerNoticeData();\r\n    }\r\n}\r\n\r\n\r\n// @\r\nexport class MapDataVO {\r\n    public col: number = 0;\r\n    public row: number = 0;\r\n    public mapList: any[] = [];\r\n    public itemID: number; // tvt add: sử dụng tại BuildIconItem.ts\r\n    public itemType: ItemTypeEnum; // tvt add: sử dụng tại BuildIconItem.ts\r\n    public cellID: number; // tvt add: sử dụng tại BuildIconItem.ts\r\n}\r\n\r\n// @\r\nexport class MapItemVo {}\r\n"]}