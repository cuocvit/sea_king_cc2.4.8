{"version":3,"sources":["assets\\start-scene\\scripts\\Caves.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { gm } from './GameManager';\r\nimport { SpecialEnum } from './Constants';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass Caves extends cc.Component {\r\n    @property(cc.Label)\r\n    private lblTips: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    private lockNode: cc.Node = null;\r\n\r\n    private funCellID: number = 143;\r\n\r\n    protected onEnable(): void {\r\n        gm.ui.on(\"open_special_fun\", this.openSpecialFun, this);\r\n        this.initCavesNode();\r\n    }\r\n\r\n    private openSpecialFun(cellID: number): void {\r\n        if (cellID == this.funCellID) {\r\n            this.initCavesNode();\r\n        }\r\n    }\r\n\r\n    private initCavesNode(): void {\r\n        const SpecialByID = gm.data.config_data.getSpecialByID(SpecialEnum.CAVES_TYPE);\r\n        if (SpecialByID) {\r\n            if (gm.data.mapCell_data.role_map_data[SpecialByID.unlock]) {\r\n                const special = gm.data.mapCell_data.specialList[SpecialEnum.CAVES_TYPE];\r\n                if (1 == special.state) {\r\n                    this.lblTips.string = \"Kho báu tổ tiên truyền đời! Mau lên đảo khám phá ngay!\";\r\n                    this.lockNode.active = true;\r\n                } else if (2 == special.state) {\r\n                    this.lockNode.active = false;\r\n                    const tipsList = [\"Chiến đấu vì sự sinh tồn, chiến đấu vì bộ lạc!\", \"Chúng ta là những chiến binh tự do!\", \"Hãy cân nhắc sức mạnh của mình trước khi cướp bóc!\"];\r\n                    this.lblTips.string = \"Chiến đấu vì sự sinh tồn, chiến đấu vì bộ lạc!\";\r\n                    this.node.stopAllActions();\r\n                    this.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(5), cc.callFunc(() => {\r\n                        const randomIndex = Math.floor(Math.random() * tipsList.length);\r\n                        this.lblTips.string = tipsList[randomIndex];\r\n                    }))));\r\n                }\r\n            } else {\r\n                this.lblTips.string = \"Mở khóa yêu cầu kết nối đảo với đất liền!!!\";\r\n                this.lockNode.active = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    private onClick(): void {\r\n        const specialByID = gm.data.config_data.getSpecialByID(SpecialEnum.CAVES_TYPE);\r\n        if (!(specialByID && !gm.data.mapCell_data.role_map_data[specialByID.unlock])) {\r\n            gm.ui.mapMainUI.handAnim.active = false;\r\n            gm.ui.mapMainUI.handAnim.active = false;\r\n            const special = gm.data.mapCell_data.specialList[SpecialEnum.CAVES_TYPE];\r\n            if (1 == special.state) {\r\n                gm.ui.mapMainUI.showCavesLock();\r\n            } else if (2 == special.state) {\r\n                if (gm.data.fight_temp_data.match_caves_map()) {\r\n                    (gm.ui.set_module_args(gm.const.GOBATTLE.key, 2),\r\n                        gm.ui.async_show_module(gm.const.GOBATTLE))\r\n                } else {\r\n                    gm.ui.show_notice(\"Đã đạt cấp độ cao nhất, hãy chờ cấp độ tiếp theo!!!\");\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.ui.off(\"open_special_fun\", this.openSpecialFun, this)\r\n    }\r\n}\r\n\r\n// export default Caves;"]}