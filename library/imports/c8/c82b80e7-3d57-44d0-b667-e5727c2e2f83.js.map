{"version":3,"sources":["assets\\start-scene\\scripts\\WeakGuide.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// @\r\nimport { gm } from './GameManager';\r\nimport { NodePoolItem } from './NodePoolItem';\r\nimport { TempData } from './TempData';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n// @\r\nexport enum Direction {\r\n    LEFT = -1,\r\n    RIGHT = 1\r\n}\r\n\r\n// @\r\ninterface Data {\r\n    tip_content: string;\r\n    tip_offset: cc.Vec3;\r\n    dir: number;\r\n    disappear_time: number;\r\n    target?: cc.Node;\r\n    callback?: () => void;\r\n}\r\n\r\n//\r\n@ccclass\r\nexport class WeakGuide extends NodePoolItem {\r\n    //\r\n    @property(cc.Animation)\r\n    private finger_anim: cc.Animation | null = null; // (public mode not used)\r\n\r\n    @property(cc.Node)\r\n    private tip_node: cc.Node | null = null;\r\n\r\n    @property(cc.RichText)\r\n    private tip_txt: cc.RichText | null = null;\r\n\r\n    // @\r\n    private _data: Data | null = null;\r\n\r\n    // @\r\n    public get data(): Data | null {\r\n        return this._data;\r\n    }\r\n\r\n    // @\r\n    public set data(value: Data) {\r\n        this._data = value;\r\n        this.update_view();\r\n    }\r\n\r\n    // @ !!!\r\n    private update_view(): void {\r\n        TempData.task_have_hand = true;\r\n        if (this._data && this._data.tip_content !== \"\") {\r\n            this.tip_node.active = true;\r\n            this.tip_node.position = this._data.tip_offset;\r\n            this.tip_txt.string = this._data.tip_content;\r\n            this.tip_node.scaleX = this._data.dir;\r\n            this.tip_txt.node.scaleX = this._data.dir;\r\n        } else {\r\n            this.tip_node.active = false;\r\n        }\r\n        //\r\n        if (this._data && this._data.disappear_time > 0) {\r\n            this.scheduleOnce(() => {\r\n                gm.pool.put(this.node);\r\n            }, this._data.disappear_time);\r\n        }\r\n        //\r\n        if (this._data && this._data.target) {\r\n            const button = this._data.target.getComponent(cc.Button);\r\n            const toggle = this._data.target.getComponent(cc.Toggle);\r\n            if (button) {\r\n                this._data.target.on(\"click\", this.on_click_or_touch_start_handler, this);\r\n            } else if (toggle) {\r\n                this._data.target.on(\"toggle\", this.on_click_or_touch_start_handler, this);\r\n            } else {\r\n                this._data.target.on(cc.Node.EventType.TOUCH_START, this.on_click_or_touch_start_handler, this);\r\n            }\r\n        }\r\n    } // end: update_view\r\n\r\n    // @\r\n    public unuse(): void {\r\n        super.unuse();\r\n        if (this._data && this._data.target) {\r\n            this._data.target.off(\"click\", this.on_click_or_touch_start_handler, this);\r\n            this._data.target.off(\"toggle\", this.on_click_or_touch_start_handler, this);\r\n            this._data.target.off(cc.Node.EventType.TOUCH_START, this.on_click_or_touch_start_handler, this);\r\n            this._data = null;\r\n        }\r\n        this.unscheduleAllCallbacks(); // (cc.Component method)\r\n    }\r\n\r\n    // @\r\n    private on_click_or_touch_start_handler(): void {\r\n        TempData.task_have_hand = false;\r\n        if (this._data && this._data.callback) {\r\n            this._data.callback();\r\n        }\r\n        gm.pool.put(this.node);\r\n    }\r\n}\r\n"]}