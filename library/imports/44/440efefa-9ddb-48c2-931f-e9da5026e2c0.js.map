{"version":3,"sources":["assets\\book\\scripts\\SceneItemDetailView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { BundleName, RewardIdEnum, SetItemNumEnum } from '../../start-scene/scripts/Constants';\r\nimport { gm } from '../../start-scene/scripts/GameManager';\r\nimport { GameModule } from '../../start-scene/scripts/GameModule';\r\nimport { Utils } from '../../start-scene/scripts/Utils';\r\nimport { ReportData } from '../../start-scene/scripts/NetUtils';\r\nimport SceneBookLogic from './SceneBookLogic';\r\nimport { BookConfig } from '../../common/configs/books';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\ninterface IconData {\r\n    sIconPath: string;\r\n    iScale: number;\r\n}\r\n\r\n@ccclass\r\nclass SceneItemDetailView extends GameModule {\r\n    @property(cc.Node)\r\n    private btn_left: cc.Node | null = null;\r\n\r\n    @property(cc.Node)\r\n    private btn_right: cc.Node | null = null;\r\n\r\n    @property(cc.Sprite)\r\n    private big_icon: cc.Sprite | null = null;\r\n\r\n    @property(cc.Node)\r\n    private list_lvs: cc.Node | null = null;\r\n\r\n    @property(cc.Label)\r\n    private lab_name: cc.Label | null = null;\r\n\r\n    private tItemId: number[] | null;\r\n    private bIsSwitching: boolean;\r\n    private iCurIndex: number;\r\n    private readonly tLvNums: number[];\r\n\r\n    private constructor() {\r\n        super();\r\n        this.tItemId = null;\r\n        this.bIsSwitching = false;\r\n        this.iCurIndex = 0;\r\n        this.tLvNums = [1, 3, 7, 15, 31, 63, 128, 260];\r\n    }\r\n\r\n    protected onLoad(): void { }\r\n\r\n    protected onEnable(): void {\r\n        this.iCurIndex = 0;\r\n        this.tItemId = gm.ui.get_module_args(gm.const.BOOK_ITEM_DETAIL.key) as number[];\r\n\r\n        this.refreshBtnArrow();\r\n        const bookConfig = gm.config.get_row_data(\"BookConfigData\", this.tItemId[0].toString()) as BookConfig;\r\n        const iconData = this.getIconData(bookConfig);\r\n\r\n        if (this.big_icon) {\r\n            this.big_icon.node.scale = iconData.iScale;\r\n            Utils.async_set_sprite_frame(this.big_icon, BundleName.COMMON, iconData.sIconPath);\r\n        }\r\n\r\n        const isUnlocked = this.checkIsUnlock(this.tItemId[0]);\r\n        if (this.lab_name) {\r\n            this.lab_name.string = isUnlocked ? bookConfig.name : \"\";\r\n        }\r\n\r\n        if (this.big_icon) {\r\n            this.big_icon.node.opacity = isUnlocked ? 255 : 171;\r\n            this.big_icon.node.color = isUnlocked ? cc.Color.WHITE : cc.Color.BLACK;\r\n        }\r\n\r\n        this.refreshLvList();\r\n    }\r\n\r\n    private switchIndex(direction: number): void {\r\n        if (direction !== 0) {\r\n            this.iCurIndex += direction;\r\n            const bookConfig = gm.config.get_row_data(\"BookConfigData\", this.tItemId[this.iCurIndex].toString()) as BookConfig;\r\n            const targetX = direction > 0 ? 0 : 720;\r\n            const resetX = direction > 0 ? 720 : 0;\r\n\r\n            this.bIsSwitching = true;\r\n\r\n            const isUnlocked = this.checkIsUnlock(this.tItemId[this.iCurIndex]);\r\n            if (this.lab_name) {\r\n                this.lab_name.string = isUnlocked ? bookConfig.name : \"\";\r\n            }\r\n\r\n            cc.tween(this.big_icon.node).to(0.1, { x: targetX }).call(() => {\r\n                if (this.big_icon) {\r\n                    this.big_icon.node.opacity = 0;\r\n                    this.big_icon.node.x = resetX;\r\n\r\n                    const iconData = this.getIconData(bookConfig);\r\n\r\n                    Utils.async_set_sprite_frame(this.big_icon, BundleName.COMMON, iconData.sIconPath, () => {\r\n                        if (this.big_icon) {\r\n                            this.big_icon.node.scale = iconData.iScale;\r\n                            this.big_icon.node.opacity = isUnlocked ? 255 : 171;\r\n                            this.big_icon.node.color = isUnlocked ? cc.Color.WHITE : cc.Color.BLACK;\r\n                        }\r\n                    }, this);\r\n\r\n                    cc.tween(this.big_icon.node).to(0.1, { x: 0 }).call(() => {\r\n                        this.refreshLvList();\r\n                        this.refreshBtnArrow();\r\n                        this.bIsSwitching = false;\r\n                    }).start();\r\n                }\r\n            }).start();\r\n        } else {\r\n            this.refreshLvList();\r\n        }\r\n    }\r\n\r\n    private getIconData(bookConfig: BookConfig): IconData {\r\n        let iconPath = \"res/handbook/\" + bookConfig.icon;\r\n        let scale = 2;\r\n\r\n        if (bookConfig.is_big_icon == 1) {\r\n            iconPath = \"res/handbookBig/\" + bookConfig.icon;\r\n            scale = 1;\r\n        }\r\n\r\n        return { sIconPath: iconPath, iScale: scale };\r\n    }\r\n\r\n    private refreshLvList(): void {\r\n        const levelCount = this.list_lvs?.childrenCount || 0;\r\n        for (let index = 0; index < levelCount; index++) {\r\n            const levelCell = this.list_lvs?.children[index];\r\n            if (levelCell) {\r\n                this.refreshOneLvCell(levelCell, index);\r\n            }\r\n        }\r\n    }\r\n\r\n    private refreshOneLvCell(cellNode: cc.Node, index: number): void {\r\n        const itemId = this.tItemId[index];\r\n        cellNode.active = itemId != null;\r\n\r\n        if (itemId != null) {\r\n            const bookConfig = gm.config.get_row_data(\"BookConfigData\", itemId.toString()) as BookConfig;\r\n            const arrowIcon = this.getChild(cellNode, \"icon_arrow_min\")\r\n            const selectionIndicator = this.getChild(cellNode, \"select\");\r\n            const newIndicator = this.getChild(cellNode, \"new\");\r\n            const numLabel = this.getChildComp(cellNode, \"lab_num\", cc.Label);\r\n            const nameLabel = this.getChildComp(cellNode, \"lab_name\", cc.Label);\r\n            const iconSprite = this.getChildComp(cellNode, \"icon\", cc.Sprite);\r\n\r\n            if (iconSprite) {\r\n                iconSprite.node.scale = 0.75;\r\n                Utils.async_set_sprite_frame(iconSprite, BundleName.COMMON, \"res/handbook/\" + bookConfig.icon);\r\n            }\r\n\r\n            if (selectionIndicator) {\r\n                selectionIndicator.active = this.iCurIndex == index;\r\n            }\r\n\r\n            if (arrowIcon) {\r\n                arrowIcon.active = index > 0 && index !== 4;\r\n            }\r\n\r\n            if (numLabel) {\r\n                numLabel.node.active = false;\r\n            }\r\n            if (nameLabel) {\r\n                nameLabel.string = \"\";\r\n            }\r\n\r\n            const isUnlocked = this.checkIsUnlock(itemId);\r\n            if (iconSprite) {\r\n                iconSprite.node.opacity = isUnlocked ? 255 : 171;\r\n                iconSprite.node.color = isUnlocked ? cc.Color.WHITE : cc.Color.BLACK;\r\n            }\r\n\r\n            const hasReward = isUnlocked && gm.data.mapCell_data.checkBookItemHaveUnlockReward(itemId);\r\n            if (newIndicator) {\r\n                newIndicator.active = hasReward;\r\n            }\r\n\r\n            if (isUnlocked) {\r\n                if (numLabel && bookConfig.sub_type == SceneBookLogic.SUB_TYPE_MATERIAL_NORMAL) {\r\n                    numLabel.node.active = true;\r\n                    numLabel.string = \"X\" + this.tLvNums[index];\r\n                }\r\n                if (nameLabel) {\r\n                    nameLabel.string = bookConfig.name;\r\n                }\r\n            }\r\n\r\n            if (hasReward) {\r\n                const rewardIcon = this.getChildComp(newIndicator, \"reward_icon\", cc.Sprite);\r\n                if (rewardIcon) {\r\n                    rewardIcon.node.scale = 0.45;\r\n                    Utils.async_set_sprite_frame(rewardIcon, BundleName.COMMON, \"res/handbook/\" + bookConfig.reward);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private checkIsUnlock(key: number): boolean {\r\n        return gm.data.mapCell_data.checkBookItemIsUnlock(key);\r\n    }\r\n\r\n    private gainReward(index: number): void {\r\n        const itemId = this.tItemId[index];\r\n\r\n        if (gm.data.mapCell_data.checkBookItemHaveUnlockReward(itemId)) {\r\n            const itemConfig = gm.data.config_data.getItemCfgByID(itemId);\r\n\r\n            if (itemConfig) {\r\n                gm.channel.report_event(\"receive_handbook_reward\", {\r\n                    event_desc: \"领取图鉴奖励\",\r\n                    desc: \"领取图鉴奖励\" + itemConfig.name\r\n                });\r\n                ReportData.instance.report_once_point(10831);\r\n                ReportData.instance.report_point(10832);\r\n            }\r\n\r\n            const rewardData = gm.config.get_row_data(\"BookConfigData\", itemId.toString()) as BookConfig;\r\n\r\n            if (rewardData.reward == 11003) {\r\n                gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.ADD_ITEM_TYPE, rewardData.num);\r\n                gm.ui.show_coin_fly(RewardIdEnum.DIAMOND, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n            } else if (rewardData.reward == 11002) {\r\n                gm.data.mapCell_data.setAddGameCoin(SetItemNumEnum.ADD_ITEM_TYPE, rewardData.num);\r\n                gm.ui.show_coin_fly(RewardIdEnum.GOLD, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n            }\r\n\r\n            gm.data.mapCell_data.setBookItemGainUnlockReward(itemId);\r\n            gm.ui.get_module(gm.const.BOOK).getLogic().refreshRed();\r\n        }\r\n    }\r\n\r\n    private refreshBtnArrow(): void {\r\n        this.btn_left.active = this.tItemId[this.iCurIndex - 1] != null;\r\n        this.btn_right.active = this.tItemId[this.iCurIndex + 1] != null;\r\n    }\r\n\r\n    editor_on_button_click_handler(button: cc.Event, event: string | null = null): void {\r\n        switch (button.target.name) {\r\n            case \"btn_close\":\r\n                gm.ui.async_hide_module(gm.const.BOOK_ITEM_DETAIL);\r\n                break;\r\n            case \"btn_arrow_L\":\r\n                if (this.bIsSwitching) return;\r\n                this.switchIndex(-1);\r\n                break;\r\n            case \"btn_arrow_R\":\r\n                if (this.bIsSwitching) return;\r\n                this.switchIndex(1);\r\n                break;\r\n            case \"btn_lv\":\r\n                let levelIndex = 0;\r\n                const totalLevels = this.list_lvs?.childrenCount || 0;\r\n\r\n                for (let i = 0; i < totalLevels; i++) {\r\n                    if (this.list_lvs?.children[i].uuid == button.target.parent.uuid) {\r\n                        levelIndex = i;\r\n                    }\r\n                }\r\n\r\n                const levelDifference = levelIndex - this.iCurIndex;\r\n                this.gainReward(levelIndex);\r\n                this.switchIndex(levelDifference);\r\n\r\n                console.log(\"btn_lv iLvIndex:\" + levelIndex);\r\n\r\n                const bookModule = gm.ui.get_module(gm.const.BOOK);\r\n                if (bookModule) {\r\n                    bookModule.getLogic().refreshCurTab();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        this.tItemId = null;\r\n    }\r\n\r\n    private getChildComp<T>(parentNode: cc.Node, childName: string, componentType: { new(): T }): T | null {\r\n        const childNode = this.getChild(parentNode, childName);\r\n        return childNode ? childNode.getComponent(componentType) : null;\r\n    }\r\n\r\n    private getChild(parentNode: cc.Node, childPath: string): cc.Node | null {\r\n        const names = childPath.split(\"/\");\r\n        let currentNode: cc.Node | null = parentNode;\r\n\r\n        for (let i = 0; i < names.length; i++) {\r\n            if (currentNode == null) {\r\n                cc.error(\"Utils getChild childPath: \" + childPath + \" index: \" + (i - 1) + \" name: \" + names[i - 1]);\r\n                return null;\r\n            }\r\n            currentNode = currentNode.getChildByName(names[i]);\r\n        }\r\n        return currentNode;\r\n    }\r\n}\r\n"]}