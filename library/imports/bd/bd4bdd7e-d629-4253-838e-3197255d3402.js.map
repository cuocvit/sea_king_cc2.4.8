{"version":3,"sources":["assets\\start-scene\\scripts\\RecordData.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { StorageBase } from './StorageBase';\r\nimport { RewardIdEnum } from './Constants';\r\nimport { gm } from './GameManager';\r\n\r\n// @\r\nexport class WarehouseItemData {\r\n    public id: number;\r\n    public value: number;\r\n\r\n    constructor() {\r\n        this.id = 0;\r\n        this.value = 0;\r\n    }\r\n}\r\n\r\n// @\r\nexport class RecordData extends StorageBase {\r\n    public static EVENT_DATA_CHANGE: string = \"record_data_change\";\r\n    public static RECORD_STATE_CHANGE: string = \"record_state_change\";\r\n    public static AUTO_END_RECORD_TIME: number = 20;\r\n    public static MIN_RECORD_TIME: number = 5;\r\n    //\r\n    public STORAGE_KEY: string;\r\n    public share_record_count: number;\r\n    public left_push_share_count: number;\r\n    public reward_array: WarehouseItemData[];\r\n    public reward_data: WarehouseItemData;\r\n    public push_share_reward_data: WarehouseItemData;\r\n    public record_state: number;\r\n    public record_type: number;\r\n    public record_timestamp: number;\r\n    public is_init: boolean;\r\n\r\n    // @\r\n    constructor() {\r\n        super();\r\n        this.STORAGE_KEY = \"RecordData\";\r\n        this.share_record_count = 0;\r\n        this.left_push_share_count = 0;\r\n        this.reward_array = [];\r\n        this.record_state = 0;\r\n        this.record_type = 0;\r\n        this.record_timestamp = 0;\r\n        this.is_init = false;\r\n    }\r\n\r\n    //\r\n    public async_read_data<T>(callback?: (data: T) => void): void {\r\n        const self = this;\r\n        super.async_read_data((data: T) => {\r\n            if (self.is_init) {\r\n                for (let i = 0; i < self.reward_array.length; i++) {\r\n                    Object.setPrototypeOf(self.reward_array[i], WarehouseItemData.prototype);\r\n                }\r\n                Object.setPrototypeOf(self.reward_data, WarehouseItemData.prototype);\r\n            } else {\r\n                self.reward_data = new WarehouseItemData();\r\n                self.reward_data.id = RewardIdEnum.GOLD;\r\n                self.reward_data.value = 100;\r\n                //\r\n                self.push_share_reward_data = new WarehouseItemData();\r\n                self.push_share_reward_data.id = RewardIdEnum.DIAMOND;\r\n                self.push_share_reward_data.value = 100;\r\n                self.share_record_count = 0;\r\n                self.left_push_share_count = gm.const.MAX_PUSH_SHARE_COUNT;\r\n                self.is_init = true;\r\n                self.async_write_data();\r\n            }\r\n            self.record_state = 0;\r\n            self.record_timestamp = 0;\r\n            self.record_type = 0;\r\n            if (callback) callback(data);\r\n        });\r\n    }\r\n\r\n    // @\r\n    public async_write_data(callback?: () => void): void {\r\n        gm.data.event_emitter.emit(RecordData.EVENT_DATA_CHANGE);\r\n        super.async_write_data(callback);\r\n    }\r\n}\r\n"]}