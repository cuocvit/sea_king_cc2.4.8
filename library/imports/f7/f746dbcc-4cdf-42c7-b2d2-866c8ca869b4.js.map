{"version":3,"sources":["assets\\start-scene\\scripts\\LadderEntry.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// +-+\r\nimport { NodePoolItem } from './NodePoolItem';\r\nimport { ServerData } from './ServerData';\r\nimport { gm } from './GameManager';\r\nimport { Utils } from './Utils';\r\nimport { BundleName, BuildTypeEnum } from './Constants';\r\nimport { LadderRewardConfig } from '../../common/configs/ladder_reward';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass LadderEntry extends NodePoolItem {\r\n    @property(cc.Sprite)\r\n    private lv_spr: cc.Sprite | null = null;\r\n\r\n    @property(cc.Label)\r\n    private star_lbl: cc.Label | null = null;\r\n\r\n    @property(cc.Label)\r\n    private rank_lbl: cc.Label | null = null;\r\n\r\n    @property(cc.Button)\r\n    private entry_btn: cc.Button | null = null;\r\n\r\n    protected onEnable(): void {\r\n        gm.data.event_emitter.on(\"ladder_star_change\", this.update_view, this);\r\n        gm.data.event_emitter.on(\"ladder_achievement_upgrade\", this.play_ladder_achievement_upgrade, this);\r\n        gm.data.event_emitter.on(\"ladder_upgrade\", this.on_ladder_upgrade, this);\r\n        gm.data.event_emitter.on(\"ladder_demotion\", this.on_ladder_demotion, this);\r\n        gm.data.event_emitter.on(ServerData.EVENT_DATA_CHANGE, this.update_view, this);\r\n        this.update_view();\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.data.event_emitter.off(\"ladder_star_change\", this.update_view, this);\r\n        gm.data.event_emitter.off(\"ladder_achievement_upgrade\", this.play_ladder_achievement_upgrade, this);\r\n        gm.data.event_emitter.off(\"ladder_upgrade\", this.on_ladder_upgrade, this);\r\n        gm.data.event_emitter.off(\"ladder_demotion\", this.on_ladder_demotion, this);\r\n        gm.data.event_emitter.off(ServerData.EVENT_DATA_CHANGE, this.update_view, this);\r\n    }\r\n\r\n    private on_ladder_upgrade(): void {\r\n        cc.log(\"on_ladder_upgrade\");\r\n        gm.ui.set_module_args(gm.const.LADDERUPLVLANIMPVP.key, true);\r\n        gm.ui.async_show_module(gm.const.LADDERUPLVLANIMPVP);\r\n    }\r\n\r\n    private on_ladder_demotion(): void {\r\n        cc.log(\"on_ladder_demotion\");\r\n        gm.ui.set_module_args(gm.const.LADDERUPLVLANIMPVP.key, false);\r\n        gm.ui.async_show_module(gm.const.LADDERUPLVLANIMPVP);\r\n    }\r\n\r\n    private play_ladder_achievement_upgrade(): void {\r\n        gm.ui.async_show_module(gm.const.LADDERUPLVLANIM);\r\n    }\r\n\r\n    private update_view(): void {\r\n        const ladderTempData = gm.data.ladder_temp_data;\r\n        const rankLevel = ladderTempData.convert_rank_to_lv(ladderTempData.rank);\r\n        const rowData = gm.config.get_row_data(\"LadderRewardConfigData\", rankLevel.toString()) as LadderRewardConfig;\r\n\r\n        if (rowData) {\r\n            Utils.async_set_sprite_frame(this.lv_spr, BundleName.LADDER, \"res/\" + rowData.iconId);\r\n        }\r\n\r\n        this.star_lbl.string = ladderTempData.total_star.toString();\r\n        this.rank_lbl.string = ladderTempData.rank > 0 ? \"Xếp hạng:\" + ladderTempData.rank : \"Xếp hạng:200+\";\r\n    }\r\n\r\n    private reset(): void {\r\n        this.lv_spr.spriteFrame = null;\r\n        this.star_lbl.string = \"\";\r\n        this.rank_lbl.string = \"\";\r\n    }\r\n\r\n    private editor_on_button_click_handler(event: cc.Event): void {\r\n        if (event.target == this.entry_btn.node) {\r\n            const buildData = gm.data.mapCell_data.getBuildDataByType(BuildTypeEnum.GARRISION_TYPE)\r\n            if (!buildData || buildData.buildLvl < 1) {\r\n                gm.ui.show_notice(\"Điều kiện mở Liên Minh Hải Vương: Quân đồn trú đạt cấp 1\");\r\n            } else {\r\n                gm.ui.show_panel(gm.const.Ladder);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport { LadderEntry };"]}