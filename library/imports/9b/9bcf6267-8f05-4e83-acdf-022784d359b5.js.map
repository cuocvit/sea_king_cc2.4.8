{"version":3,"sources":["assets\\mail\\scripts\\MailInboxItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { gm } from '../../start-scene/scripts/GameManager';\r\nimport { ListViewItem } from '../../start-scene/scripts/ListViewItem';\r\nimport { Utils } from '../../start-scene/scripts/Utils';\r\nimport { BundleName } from '../../start-scene/scripts/Constants';\r\nimport { MailInboxItemData } from '../../start-scene/scripts/MailTempData';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass MailInboxItem extends ListViewItem {\r\n  @property(cc.Button)\r\n  private open_btn: cc.Button = null;\r\n\r\n  @property(cc.Sprite)\r\n  private icon_spr: cc.Sprite = null;\r\n\r\n  @property(cc.Label)\r\n  private title_lbl: cc.Label = null;\r\n\r\n  @property(cc.Label)\r\n  private content_lbl: cc.Label = null;\r\n\r\n  @property(cc.Node)\r\n  private unread_node: cc.Node = null;\r\n\r\n  @property(cc.Node)\r\n  private read_node: cc.Node = null;\r\n\r\n  public _data: MailInboxItemData;\r\n\r\n  public get data(): MailInboxItemData {\r\n    return this._data;\r\n  }\r\n\r\n  public set data(value: MailInboxItemData) {\r\n    this._data = value;\r\n    this.update_view();\r\n  }\r\n\r\n  public update_view(): void {\r\n    this.title_lbl.string = this._data.mail_title;\r\n    this.content_lbl.string = this._data.mail_text;\r\n    this.unread_node.active = this._data.op_status == 0;\r\n    this.read_node.active = this._data.op_status == 1;\r\n    Utils.async_set_sprite_frame(this.icon_spr, BundleName.MAIL, \"res/icon_\" + this._data.mail_type);\r\n  }\r\n\r\n  public reset(): void {\r\n    this.title_lbl.string = \"\";\r\n    this.content_lbl.string = \"\";\r\n    this.unread_node.active = false;\r\n    this.read_node.active = false;\r\n    this.icon_spr.spriteFrame = null;\r\n  }\r\n\r\n  private editor_on_button_click_handler(event: cc.Event): void {\r\n    if (event.target == this.open_btn.node) {\r\n      if (0 == this._data.op_status) {\r\n        const serverData = gm.data.server_data\r\n        const requestData = {\r\n          uid: serverData.uid,\r\n          token: serverData.token,\r\n          mail_id: this._data.mail_id,\r\n          op_status: 1,\r\n          reward_status: 0\r\n        };\r\n\r\n        serverData.op_player_email((response) => {\r\n          if (0 == response.ResultCode) {\r\n            this._data.op_status = 1;\r\n            this.update_view();\r\n            gm.ui.set_module_args(gm.const.MailDetails.key, {\r\n              data: this._data\r\n            });\r\n            gm.ui.async_show_module(gm.const.MailDetails);\r\n          }\r\n        }, requestData)\r\n\r\n      } else {\r\n        gm.ui.set_module_args(gm.const.MailDetails.key, {\r\n          data: this._data\r\n        });\r\n        gm.ui.async_show_module(gm.const.MailDetails);\r\n      }\r\n    }\r\n  }\r\n}\r\n"]}