{"version":3,"sources":["assets\\start-scene\\scripts\\UnLockAreaCloud.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM;AACN,6CAAmC;AACnC,yCAA4D;AAC5D,mDAAkD;AAClD,uCAAwC;AAElC,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA8B,mCAAY;IAA1C;QAAA,qEA8EC;QA5EW,aAAO,GAAoB,IAAI,CAAC;QAGhC,aAAO,GAAoB,IAAI,CAAC;QAGhC,gBAAU,GAAoB,IAAI,CAAC;QAGnC,aAAO,GAAmB,IAAI,CAAC;QAE/B,cAAQ,GAAW,CAAC,CAAC;;IAiEjC,CAAC;IA/Da,kCAAQ,GAAlB;QACI,IAAI,CAAC,QAAQ,GAAG,gBAAE,CAAC,EAAE,CAAC,eAAe,CAAC,gBAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC,GAAG,CAAW,CAAC;QAChF,IAAM,QAAQ,GAAW,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,yBAAa,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC;QACpG,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,QAAQ,IAAI,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC;QACjF,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC;QACtE,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,sBAAsB,GAAG,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,GAAG,gBAAgB,GAAG,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC;QACnK,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;QACvF,gBAAE,CAAC,OAAO,CAAC,cAAc,CAAC,+BAAc,CAAC,GAAG,CAAC,CAAC;IAClD,CAAC;IAEO,wCAAc,GAAtB;QACI,gBAAE,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IACnD,CAAC;IAEO,mCAAS,GAAjB;QACI,IAAM,GAAG,GAAW,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC;QACnE,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACtD,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACpD,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QAC3D,gBAAE,CAAC,EAAE,CAAC,iBAAiB,CAAC,gBAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;QACpD,gBAAE,CAAC,EAAE,CAAC,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAClD,gBAAE,CAAC,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC5B,gBAAE,CAAC,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE;YACnC,UAAU,EAAE,MAAM;YAClB,IAAI,EAAE,WAAW;YACjB,EAAE,EAAE,GAAG;YACP,WAAW,EAAE,MAAM;SACtB,CAAC,CAAC;QACH,qBAAU,CAAC,QAAQ,CAAC,iBAAiB,CAAC,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC;IAChG,CAAC;IAEO,wCAAc,GAAtB;QACI,IAAI,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,UAAU,IAAI,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,EAAE;YACpG,IAAM,GAAG,GAAW,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC;YACnE,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,0BAAc,CAAC,gBAAgB,EAAE,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC;YAC5H,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACtD,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACpD,gBAAE,CAAC,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YAC3D,gBAAE,CAAC,EAAE,CAAC,iBAAiB,CAAC,gBAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;YACpD,gBAAE,CAAC,EAAE,CAAC,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAClD,gBAAE,CAAC,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAC5B,gBAAE,CAAC,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE;gBACnC,UAAU,EAAE,MAAM;gBAClB,IAAI,EAAE,WAAW;gBACjB,EAAE,EAAE,GAAG;gBACP,WAAW,EAAE,MAAM;aACtB,CAAC,CAAC;YACH,qBAAU,CAAC,QAAQ,CAAC,iBAAiB,CAAC,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;SACnG;aAAM;YACH,gBAAE,CAAC,EAAE,CAAC,eAAe,CAAC,gBAAE,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YACpD,gBAAE,CAAC,EAAE,CAAC,iBAAiB,CAAC,gBAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;SAC/C;IACL,CAAC;IAEO,sCAAY,GAApB;QACI,gBAAE,CAAC,EAAE,CAAC,iBAAiB,CAAC,gBAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;QACpD,IAAM,QAAQ,GAAW,gBAAE,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC;QAC7E,gBAAE,CAAC,EAAE,CAAC,SAAS,CAAC,0BAA0B,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC;IACpE,CAAC;IAES,mCAAS,GAAnB;QACI,gBAAE,CAAC,OAAO,CAAC,cAAc,CAAC,+BAAc,CAAC,GAAG,CAAC,CAAC;IAClD,CAAC;IA3ED;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;oDACqB;IAGxC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;oDACqB;IAGxC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;uDACwB;IAG3C;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACqB;IAXrC,eAAe;QADpB,OAAO;OACF,eAAe,CA8EpB;IAAD,sBAAC;CA9ED,AA8EC,CA9E6B,EAAE,CAAC,SAAS,GA8EzC;AAED,kBAAe,eAAe,CAAC","file":"","sourceRoot":"/","sourcesContent":["// *-*\r\nimport { gm } from './GameManager';\r\nimport { SetItemNumEnum, BuildTypeEnum } from './Constants';\r\nimport { BANNER_AD_TYPE } from './ChannelManager';\r\nimport { ReportData } from './NetUtils';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass UnLockAreaCloud extends cc.Component {\r\n    @property(cc.Label)\r\n    private lblName: cc.Label | null = null;\r\n\r\n    @property(cc.Label)\r\n    private lblDesc: cc.Label | null = null;\r\n\r\n    @property(cc.Label)\r\n    private lblDiamond: cc.Label | null = null;\r\n\r\n    @property(cc.Node)\r\n    private btnNode: cc.Node | null = null;\r\n\r\n    private _curType: number = 0;\r\n\r\n    protected onEnable(): void {\r\n        this._curType = gm.ui.get_module_args(gm.const.UNLOCKAREACLOUDOP.key) as number;\r\n        const buildLvl: number = gm.data.mapCell_data.getBuildDataByType(BuildTypeEnum.TOWER_TYPE).buildLvl;\r\n        this.btnNode.active = buildLvl >= gm.const.localCloudAreaList[this._curType].lvl;\r\n        this.lblName.string = gm.const.localCloudAreaList[this._curType].name;\r\n        this.lblDesc.string = \"Thành phố chính cấp \" + gm.const.localCloudAreaList[this._curType].lvl + \" sẽ mở khóa.\\n\" + gm.const.localCloudAreaList[this._curType].desc;\r\n        this.lblDiamond.string = gm.const.localCloudAreaList[this._curType].diamond.toString();\r\n        gm.channel.show_banner_ad(BANNER_AD_TYPE.ALL);\r\n    }\r\n\r\n    private onClickWatchAd(): void {\r\n        gm.channel.show_video_ad(this.watchAdCb, this);\r\n    }\r\n\r\n    private watchAdCb(): void {\r\n        const lvl: number = gm.const.localCloudAreaList[this._curType].lvl;\r\n        gm.data.mapCell_data.unlockSpecialArea(this._curType);\r\n        gm.data.mapCell_data.openNewAreaByID(this._curType);\r\n        gm.data.mapCell_data.unlockNewAreaID(this._curType, false);\r\n        gm.ui.async_hide_module(gm.const.UNLOCKAREACLOUDOP);\r\n        gm.ui.emit(\"unlock_cloud_refresh\", this._curType);\r\n        gm.ui.emit(\"unLockNewArea\");\r\n        gm.channel.report_event(\"unlock_area\", {\r\n            event_desc: \"解锁区域\",\r\n            desc: \"%d级区域%s人数\",\r\n            lv: lvl,\r\n            unlock_type: \"视频解锁\"\r\n        });\r\n        ReportData.instance.report_once_point(gm.const.localCloudAreaList[this._curType].reportNum);\r\n    }\r\n\r\n    private onClickDiamond(): void {\r\n        if (gm.data.mapCell_data.roleCoinData.diamondNum >= gm.const.localCloudAreaList[this._curType].diamond) {\r\n            const lvl: number = gm.const.localCloudAreaList[this._curType].lvl;\r\n            gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.REDUCE_ITEM_TYPE, gm.const.localCloudAreaList[this._curType].diamond);\r\n            gm.data.mapCell_data.unlockSpecialArea(this._curType);\r\n            gm.data.mapCell_data.openNewAreaByID(this._curType);\r\n            gm.data.mapCell_data.unlockNewAreaID(this._curType, false);\r\n            gm.ui.async_hide_module(gm.const.UNLOCKAREACLOUDOP);\r\n            gm.ui.emit(\"unlock_cloud_refresh\", this._curType);\r\n            gm.ui.emit(\"unLockNewArea\");\r\n            gm.channel.report_event(\"unlock_area\", {\r\n                event_desc: \"解锁区域\",\r\n                desc: \"%d级区域%s人数\",\r\n                lv: lvl,\r\n                unlock_type: \"钻石解锁\"\r\n            });\r\n            ReportData.instance.report_once_point(gm.const.localCloudAreaList[this._curType].reportNum + 1);\r\n        } else {\r\n            gm.ui.set_module_args(gm.const.GETCOINOP.key, true);\r\n            gm.ui.async_show_module(gm.const.GETCOINOP);\r\n        }\r\n    }\r\n\r\n    private onClickClose(): void {\r\n        gm.ui.async_hide_module(gm.const.UNLOCKAREACLOUDOP);\r\n        const mapIndex: number = gm.const.localCloudAreaList[this._curType].mapIndex;\r\n        gm.ui.mapMainUI.playUnLockMainTowerMoveMap(mapIndex.toString());\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.channel.hide_banner_ad(BANNER_AD_TYPE.ALL);\r\n    }\r\n}\r\n\r\nexport default UnLockAreaCloud;"]}