{"version":3,"sources":["assets\\start-scene\\scripts\\WXMiniGame.ts"],"names":[],"mappings":";;;;;;;AAAA,6CAAmC;AACnC,mDAAwF;AACxF,iCAAgC;AAwBhC;IA2BI;QACI,IAAI,CAAC,oBAAoB,GAAG,GAAG,CAAC;QAChC,IAAI,CAAC,mBAAmB,GAAG,CAAC,yBAAyB,CAAC,CAAC;QACvD,IAAI,CAAC,kBAAkB,GAAG,CAAC,yBAAyB,CAAC,CAAC;QACtD,IAAI,CAAC,mBAAmB,GAAG,yBAAyB,CAAC;QACrD,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAC3B,IAAI,CAAC,qBAAqB,GAAG,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,CAAC,uBAAuB,GAAG,CAAC,KAAK,CAAC,CAAC;QACvC,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,sBAAsB,GAAG,EAAE,CAAC;QACjC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;QAC7B,IAAI,CAAC,uBAAuB,GAAG,KAAK,CAAC;QACrC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;QAC7B,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;QACvB,IAAI,CAAC,cAAc,GAAG;YAClB,KAAK,EAAE,WAAW;YAClB,GAAG,EAAE,yDAAyD;SACjE,CAAC;QACF,IAAI,CAAC,kBAAkB,GAAG,CAAC,CAAC;QAC5B,IAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;QAC1B,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;QACpC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QACzB,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;QAC/B,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;IACzB,CAAC;IAED,sBAAkB,sBAAQ;aAA1B;YACI,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;gBACjB,IAAI,CAAC,SAAS,GAAG,IAAI,UAAU,EAAE,CAAC;aACrC;YACD,OAAO,IAAI,CAAC,SAAS,CAAC;QAC1B,CAAC;;;OAAA;IAEM,qCAAgB,GAAvB,UAAwB,IAAgB;QACpC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,cAAQ,CAAC,CAAC,CAAC;QAC5B,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,cAAQ,CAAC,CAAC,CAAC;QAC5B,IAAI,CAAC,mBAAmB,CAAC,+BAAc,CAAC,GAAG,CAAC,GAAG,yBAAyB,CAAC;QACzE,IAAI,CAAC,kBAAkB,CAAC,qCAAoB,CAAC,GAAG,CAAC,GAAG,yBAAyB,CAAC;QAC9E,IAAI,CAAC,mBAAmB,GAAG,yBAAyB,CAAC;QACrD,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,OAAO,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;QACpB,IAAI,CAAC,YAAY,GAAG,+BAAc,CAAC,YAAY,CAAC,WAAW,CAAC;QAC5D,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,EAAE,CAAC;QACP,OAAO,IAAI,CAAC;IAChB,CAAC;IAEO,oCAAe,GAAvB;QAAA,iBAwBC;QAvBG,OAAO,CAAC,GAAG,CAAC,sCAAsC,CAAC,CAAC;QACpD,MAAM,CAAC,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QAC5B,MAAM,CAAC,EAAE,CAAC,iBAAiB,CAAC;YACxB,IAAI,KAAY,CAAC;YACjB,IAAI,CAAC,IAAI,KAAI,CAAC,YAAY,CAAC,MAAM,EAAE;gBAC/B,KAAK,GAAG,KAAI,CAAC,cAAc,CAAC;aAC/B;iBAAM;gBACH,KAAK,GAAG,KAAI,CAAC,YAAY,CAAC,aAAK,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,EAAE,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC;aACnF;YAED,OAAO;gBACH,KAAK,EAAE,KAAK,CAAC,KAAK;gBAClB,QAAQ,EAAE,KAAK,CAAC,GAAG;gBACnB,OAAO,EAAE,UAAC,CAAC;oBACP,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACxC,CAAC;gBACD,IAAI,EAAE,UAAC,CAAC;oBACJ,OAAO,CAAC,GAAG,CAAC,2BAA2B,GAAG,CAAC,CAAC,CAAC;gBACjD,CAAC;aACJ,CAAA;QACL,CAAC,CAAC,CAAC;QACH,OAAO,CAAC,GAAG,CAAC,oCAAoC,CAAC,CAAC;QAClD,OAAO,IAAI,CAAC;IAChB,CAAC;IAEM,0CAAqB,GAA5B,UAA6B,IAAgB;QACzC,IAAI,EAAE,CAAC;QACP,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,sBAAW,gCAAQ;aAAnB;YACI,OAAO,IAAI,CAAC;QAChB,CAAC;;;OAAA;IAED,sBAAW,sCAAc;aAAzB;YACI,OAAO,KAAK,CAAC;QACjB,CAAC;;;OAAA;IAEM,iCAAY,GAAnB;QACI,OAAO,+BAAc,CAAC,WAAW,CAAC;IACtC,CAAC;IAEM,kCAAa,GAApB;QACI,IAAI,EAAE,CAAC,YAAY,EAAE;YACjB,EAAE,CAAC,YAAY,CAAC;gBACZ,OAAO,EAAE,UAAC,CAAC;oBACP,OAAO,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxB,CAAC;gBACD,IAAI,EAAE;oBACF,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;gBACpC,CAAC;aACJ,CAAC,CAAC;SACN;IACL,CAAC;IAEM,iCAAY,GAAnB;QACI,IAAI,EAAE,CAAC,WAAW,EAAE;YAChB,EAAE,CAAC,WAAW,CAAC;gBACX,OAAO,EAAE,UAAC,CAAC;oBACP,OAAO,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxB,CAAC;gBACD,IAAI,EAAE;oBACF,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;gBACnC,CAAC;aACJ,CAAC,CAAC;SACN;IACL,CAAC;IAED,sBAAW,+BAAO;aAAlB;YACI,OAAO,IAAI,CAAC;QAChB,CAAC;;;OAAA;IAED,sBAAW,4CAAoB;aAA/B;YACI,OAAO,KAAK,IAAI,MAAM,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC,QAAQ,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,qBAAqB,IAAI,MAAM,CAAC,EAAE,CAAC,uBAAuB,IAAI,MAAM,CAAC,EAAE,CAAC,kBAAkB,CAAC,CAAC;QACvK,CAAC;;;OAAA;IAEM,mCAAc,GAArB,UAAsB,QAAuD,EAAE,OAAY;QACvF,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC3B,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC,UAAC,CAAC;gBAC9B,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;YACnC,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,EAAE,CAAC,uBAAuB,CAAC,UAAC,CAAC;gBAChC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;gBACvB,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YAC1B,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,EAAE,CAAC,kBAAkB,CAAC;gBACzB,gBAAgB,EAAE,EAAE;gBACpB,OAAO,EAAE,UAAC,CAAC;oBACP,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;oBACjC,IAAI,QAAQ,IAAI,OAAO,EAAE;wBACrB,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;qBAC7B;gBACL,CAAC;gBACD,IAAI,EAAE,UAAC,CAAC;oBACJ,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;oBAC9B,IAAI,QAAQ,IAAI,OAAO,EAAE;wBACrB,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;qBAC7B;gBACL,CAAC;aACJ,CAAC,CAAC;SACN;IACL,CAAC;IAEM,8BAAS,GAAhB,UAAiB,QAAc,EAAE,OAAa;QAC1C,IAAI,KAAK,GAAU,SAAS,CAAA;QAC5B,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE;YAC/B,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC;SAC/B;aAAM;YACH,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,aAAK,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC;SACjF;QAED,IAAI,MAAM,CAAC,EAAE,CAAC,eAAe,IAAI,KAAK,EAAE;YACpC,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC;gBACtB,KAAK,EAAE,KAAK,CAAC,KAAK;gBAClB,QAAQ,EAAE,KAAK,CAAC,GAAG;gBACnB,OAAO,EAAE,UAAC,CAAC;oBACP,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;gBAC1C,CAAC;gBACD,IAAI,EAAE,UAAC,CAAC;oBACJ,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;gBAClB,CAAC;aACJ,CAAC,CAAC;SACN;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAEO,gCAAW,GAAnB,cAA8B,CAAC;IAExB,qCAAgB,GAAvB;QAAA,iBA6CC;QA5CG,IAAI,MAAM,CAAC,EAAE,EAAE;YACX,IAAM,UAAU,GAAG,MAAM,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC;YACjD,IAAM,aAAW,GAAG,UAAU,CAAC,WAAW,CAAC;YAC3C,IAAM,cAAY,GAAG,UAAU,CAAC,YAAY,CAAC;oCAEpC,CAAC;gBACN,CAAC;oBACG,IAAM,CAAC,GAAG,CAAC,CAAC;oBACZ,IAAM,MAAM,GAAG,KAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;oBAC3C,IAAI,IAAI,IAAI,MAAM,IAAI,EAAE,IAAI,MAAM,EAAE;wBAChC,IAAM,gBAAc,GAAa,EAAE,CAAC,cAAc,CAAC;4BAC/C,QAAQ,EAAE,MAAM;4BAChB,WAAW,EAAE,EAAE;4BACf,KAAK,EAAE;gCACH,KAAK,EAAE,KAAI,CAAC,oBAAoB;gCAChC,GAAG,EAAE,cAAY;gCACjB,IAAI,EAAE,CAAC,aAAW,GAAG,KAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC;6BACtD;yBACJ,CAAC,CAAC;wBAEH,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,gBAAc,CAAC,CAAC;wBAC3C,gBAAc,CAAC,MAAM,CAAC;4BAClB,OAAO,CAAC,GAAG,CAAC,eAAe,GAAG,MAAM,GAAG,SAAS,CAAC,CAAC;4BAClD,KAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;wBAC3C,CAAC,CAAC,CAAC;wBAEH,gBAAc,CAAC,QAAQ,CAAC,UAAC,CAAC;4BACtB,gBAAc,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,aAAW,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;4BACxD,gBAAc,CAAC,KAAK,CAAC,GAAG,GAAG,cAAY,GAAG,CAAC,CAAC,MAAM,CAAC;4BACnD,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;4BAEtD,IAAM,mBAAmB,GAAG,EAAE,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;4BAC1D,IAAM,SAAS,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;4BAEtC,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,CAAC,CAAC,KAAK,GAAG,mBAAmB,GAAG,SAAS,EAAE,CAAC,CAAC,MAAM,GAAG,mBAAmB,GAAG,SAAS,CAAC,CAAC;wBACnI,CAAC,CAAC,CAAC;wBAEH,gBAAc,CAAC,OAAO,CAAC,UAAC,CAAC;4BACrB,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;wBACnB,CAAC,CAAC,CAAC;qBACN;gBACL,CAAC,CAAC,EAAE,CAAC;;YApCT,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,CAAC,EAAE;wBAA/C,CAAC;aAqCT;SACJ;IACL,CAAC;IAEM,mCAAc,GAArB,UAAsB,KAAqB;QAA3C,iBAeC;QAdG,IAAI,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,EAAE;YACrC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;YACzC,IAAM,QAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;YAC5C,QAAM,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;gBACf,IAAI,KAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,EAAE;oBACnC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;iBACzB;qBAAM;oBACH,QAAM,CAAC,IAAI,EAAE,CAAC;oBACd,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;iBAChC;YACL,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,CAAC;gBACP,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAA;SACL;IACL,CAAC;IAEM,mCAAc,GAArB,UAAsB,KAAqB;QACvC,IAAI,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,EAAE;YACrC,IAAM,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,MAAM,EAAE;gBACR,MAAM,CAAC,IAAI,EAAE,CAAC;gBACd,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;aAC7C;SACJ;IACL,CAAC;IAEM,oCAAe,GAAtB;QACI,IAAI,IAAI,IAAI,MAAM,CAAC,EAAE,CAAC,qBAAqB,EAAE;YACzC,IAAM,UAAU,GAAG,EAAE,CAAC,iBAAiB,EAAE,CAAC,UAAU,CAAC;YACrD,IAAI,CAAC,IAAI,gBAAE,CAAC,OAAO,CAAC,eAAe,CAAC,UAAU,EAAE,OAAO,CAAC,EAAE;gBACtD,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;gBAChC,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;oBACjE,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC;wBAC1D,QAAQ,EAAE,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC;wBACxC,QAAQ,EAAE,IAAI;qBACjB,CAAC,CAAC;oBACH,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;iBACnC;aAEJ;iBAAM;gBACH,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;gBACjC,IAAM,KAAK,GAAG,qCAAoB,CAAC,GAAG,CAAC;gBACvC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,EAAE,CAAC,qBAAqB,CAAC;oBAC1D,QAAQ,EAAE,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC;iBAC3C,CAAC,CAAC;gBACH,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;aACnC;SACJ;IACL,CAAC;IAEO,wCAAmB,GAA3B,UAA4B,KAAa;QAAzC,iBAmBC;QAlBG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAC,CAAC;YAClC,EAAE,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;YACjB,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,IAAI,SAAS,KAAK,CAAC,EAAE;gBACnC,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gBAC3B,KAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,KAAI,CAAC,sBAAsB,CAAC,KAAK,CAAC,CAAC,CAAC;aACzE;iBAAM;gBACH,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gBAC3B,gBAAE,CAAC,EAAE,CAAC,WAAW,CAAC,mDAAmD,CAAC,CAAC;aAC1E;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC;YAC/B,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,UAAC,CAAC;YAClC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACnB,CAAC,CAAC,CAAA;IACN,CAAC;IAEM,kCAAa,GAApB,UAAqB,QAAqD,EAAE,OAAuB,EAAE,IAA0B;QAA/H,iBAoCC;QAnCG,IAAM,UAAU,GAAG,EAAE,CAAC,iBAAiB,EAAE,CAAC,UAAU,CAAC;QACrD,IAAI,gBAAE,CAAC,OAAO,CAAC,eAAe,CAAC,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE;YACrD,IAAI,GAAG,qCAAoB,CAAC,GAAG,CAAC;SACnC;QACD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;QACtC,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;QAC5C,IAAI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;YAC5B,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;gBACnC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;gBACxB,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;YACpB,CAAC,CAAC,CAAC,KAAK,CAAC;gBACL,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gBAC3B,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;oBACnC,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;wBACnC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;wBAC7B,EAAE,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;oBACpB,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,CAAsB;wBAC5B,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;wBACzB,IAAI,IAAI,IAAI,CAAC,CAAC,OAAO,EAAE;4BACnB,gBAAE,CAAC,EAAE,CAAC,WAAW,CAAC,0DAA0D,CAAC,CAAC;yBACjF;6BAAM;4BACH,gBAAE,CAAC,EAAE,CAAC,WAAW,CAAC,8CAA8C,CAAC,CAAC;yBACrE;wBACD,gBAAE,CAAC,OAAO,CAAC,SAAS,CAAC;4BACjB,IAAI,QAAQ,EAAE;gCACV,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;6BAC1B;wBACL,CAAC,EAAE,KAAI,CAAC,CAAC;oBACb,CAAC,CAAC,CAAC;gBACP,CAAC,CAAC,CAAA;YACN,CAAC,CAAC,CAAC;SAEN;aAAM;YACH,gBAAE,CAAC,EAAE,CAAC,WAAW,CAAC,qDAAqD,CAAC,CAAC;SAC5E;IACL,CAAC;IAED,sCAAiB,GAAjB;QACI,IAAI,EAAE,CAAC,YAAY,EAAE;YACjB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,YAAY,CAAC;gBAC5B,QAAQ,EAAE,IAAI,CAAC,WAAW;gBAC1B,WAAW,EAAE,EAAE;gBACf,OAAO,EAAE,OAAO;gBAChB,SAAS,EAAE,CAAC;gBACZ,KAAK,EAAE;oBACH,IAAI,EAAE,CAAC;oBACP,GAAG,EAAE,CAAC;oBACN,KAAK,EAAE,GAAG;oBACV,OAAO,EAAE,EAAE;iBACd;aACJ,CAAC,CAAC;YAEH,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;gBACjB,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,CAAC;gBACpB,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACnB,CAAC,CAAC,CAAC;SACN;aAAM;YACH,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;SAChC;IACL,CAAC;IAED,sBAAW,0CAAkB;aAA7B;YACI,OAAO,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC;QAC7B,CAAC;;;OAAA;IAEO,oCAAe,GAAvB;QACI,IAAI,EAAE,CAAC,YAAY,EAAE;YACjB,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACvC,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,UAAC,CAAC;oBACzB,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACrB,CAAC,CAAC,CAAC;aACN;iBAAM;gBACH,IAAI,CAAC,iBAAiB,EAAE,CAAC;gBACzB,OAAO,CAAC,GAAG,CAAC,kBAAkB,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC;aAC1D;SACJ;aAAM;YACH,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;SAChC;IACL,CAAC;IAEO,2CAAsB,GAA9B;QAAA,iBA0BC;QAzBG,IAAI,EAAE,CAAC,oBAAoB,EAAE;YACzB,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC,oBAAoB,CAAC;gBAC5C,QAAQ,EAAE,IAAI,CAAC,mBAAmB;aACrC,CAAC,CAAC;YAEH,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAC,CAAC;gBAC5B,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACnB,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC;gBACzB,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;YACjC,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC;gBACzB,KAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;YACxC,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC;gBAC1B,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAC,CAAC;gBAC5B,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAED,sBAAW,kDAA0B;aAArC;YACI,IAAI,EAAE,CAAC,oBAAoB,EAAE;gBACzB,OAAO,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;gBAChD,OAAO,IAAI,CAAC;aACf;iBAAM;gBACH,OAAO,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;gBACjD,OAAO,KAAK,CAAC;aAChB;QACL,CAAC;;;OAAA;IAEM,yCAAoB,GAA3B,UAA4B,QAAuD,EAAE,OAAY;QAC7F,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,uBAAuB,EAAE;YACvD,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,UAAC,CAAC;gBACjC,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBACzB,IAAI,QAAQ,IAAI,OAAO,EAAE;oBACrB,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;iBAC7B;YACL,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAEM,mCAAc,GAArB;QACI,IAAM,MAAM,GAAG;YACX,MAAM,EAAE;gBACJ,KAAK,EAAE,CAAC;gBACR,WAAW,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,OAAO,EAAE,GAAG,GAAG,CAAC;aACtD;YACD,SAAS,EAAE,CAAC;SACf,CAAC;QACF,OAAO,CAAC,GAAG,CAAC,6BAA6B,EAAE,MAAM,CAAC,CAAC;QACnD,MAAM,CAAC,EAAE,CAAC,mBAAmB,CAAC;YAC1B,UAAU,EAAE,CAAC;oBACT,GAAG,EAAE,OAAO;oBACZ,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;iBAChC,CAAC;SACL,CAAC,CAAC;QACH,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IACrB,CAAC;IAEM,kCAAa,GAApB;QACI,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,WAAW,CAAC;YACvC,OAAO,EAAE,CAAC;SACb,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IAChB,CAAC;IAEM,mCAAc,GAArB;QACI,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,WAAW,CAAC;YACvC,OAAO,EAAE,EAAE;SACd,CAAC,CAAC;IACP,CAAC;IAEM,2CAAsB,GAA7B;QACI,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,WAAW,CAAC;YACvC,OAAO,EAAE,GAAG;SACf,CAAC,CAAC;IACP,CAAC;IAEM,4CAAuB,GAA9B;QACI,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,WAAW,CAAC;YACvC,OAAO,EAAE,GAAG;SACf,CAAC,CAAC;IACP,CAAC;IAEM,uCAAkB,GAAzB;QACI,MAAM,CAAC,EAAE,IAAI,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,WAAW,CAAC;YACpD,OAAO,EAAE,GAAG;SACf,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IAChB,CAAC;IAEM,wCAAmB,GAA1B;QACI,MAAM,CAAC,EAAE,IAAI,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,WAAW,CAAC;YACpD,OAAO,EAAE,GAAG;SACf,CAAC,CAAC;IACP,CAAC;IAEM,gCAAW,GAAlB;QACI,IAAI,MAAM,CAAC,YAAY,EAAE;YACrB,MAAM,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC;YACrC,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;SACvC;IACL,CAAC;IAzgBc,oBAAS,GAAe,IAAI,CAAC;IAC9B,oBAAS,GAAY,KAAK,CAAC;IAygB7C,iBAAC;CA3gBD,AA2gBC,IAAA;AA3gBY,gCAAU","file":"","sourceRoot":"/","sourcesContent":["import { gm } from \"./GameManager\";\r\nimport { ChannelManager, BANNER_AD_TYPE, REWARD_VIDEO_AD_TYPE } from \"./ChannelManager\";\r\nimport { Utils } from \"./Utils\";\r\nimport { IAd } from \"./VIVOMiniGame\"\r\n\r\ninterface Share {\r\n    title: string,\r\n    url: string\r\n}\r\n\r\nexport interface BannerAd extends IAd {\r\n    style: {\r\n        width: number;\r\n        height: number;\r\n        top: number;\r\n        left: number;\r\n    };\r\n    onResize(callback: (size: { width: number; height: number }) => void): void;\r\n}\r\n\r\nexport interface VDCallback {\r\n    call: (context: ChannelManager) => void;\r\n    apply?: (target: ChannelManager) => void;\r\n}\r\n\r\n\r\nexport class WXMiniGame {\r\n    private static _instance: WXMiniGame = null;\r\n    public static ad_enable: boolean = false;\r\n    private _min_banner_ad_width: number;\r\n    private _banner_ad_id_array: string[];\r\n    private _video_ad_id_array: string[];\r\n    private _interstitial_ad_id: string;\r\n    private _grid_ad_id: string;\r\n    private _banner_ad_array: BannerAd[];\r\n    private _banner_ad_flag_array: boolean[];\r\n    private _banner_ad_loaded_array: boolean[];\r\n    private _video_ad_array: IAd[];\r\n    private _video_cb_array: VDCallback[];\r\n    private _video_cb_target_array: ChannelManager[];\r\n    private _interstitial_ad: IAd;\r\n    private _interstitial_ad_loaded: boolean;\r\n    private _app_box: IAd;\r\n    private _app_box_loaded: boolean;\r\n    private _share_array: Share[];\r\n    private _default_share: Share;\r\n    private _record_start_time: number;\r\n    private _record_end_time: number;\r\n    private _is_share_record_video: boolean;\r\n    private _is_restart: boolean;\r\n    private _ifNeedVideoShare: boolean;\r\n    private _videoPath: string;\r\n\r\n    constructor() {\r\n        this._min_banner_ad_width = 300;\r\n        this._banner_ad_id_array = [\"adunit-797181240a995471\"];\r\n        this._video_ad_id_array = [\"adunit-edb2928f9bc53151\"];\r\n        this._interstitial_ad_id = \"adunit-63d522433c1429a9\";\r\n        this._grid_ad_id = \"\";\r\n        this._banner_ad_array = [];\r\n        this._banner_ad_flag_array = [false];\r\n        this._banner_ad_loaded_array = [false];\r\n        this._video_ad_array = [];\r\n        this._video_cb_array = [];\r\n        this._video_cb_target_array = [];\r\n        this._interstitial_ad = null;\r\n        this._interstitial_ad_loaded = false;\r\n        this._app_box = null;\r\n        this._app_box_loaded = false;\r\n        this._share_array = [];\r\n        this._default_share = {\r\n            title: \"一起体验海王就是我\",\r\n            url: \"https://cdnres.qszhg.6hwan.com/tower_shoot/remote/1.jpg\"\r\n        };\r\n        this._record_start_time = 0;\r\n        this._record_end_time = 0;\r\n        this._is_share_record_video = false;\r\n        this._is_restart = false;\r\n        this._ifNeedVideoShare = false;\r\n        this._videoPath = \"\";\r\n    }\r\n\r\n    public static get instance(): WXMiniGame {\r\n        if (!this._instance) {\r\n            this._instance = new WXMiniGame();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    public load_channel_env(call: () => void): boolean {\r\n        window.wx.onHide(() => { });\r\n        window.wx.onShow(() => { }); \r\n        this._banner_ad_id_array[BANNER_AD_TYPE.ALL] = \"adunit-797181240a995471\";\r\n        this._video_ad_id_array[REWARD_VIDEO_AD_TYPE.ALL] = \"adunit-edb2928f9bc53151\";\r\n        this._interstitial_ad_id = \"adunit-63d522433c1429a9\";\r\n        this._grid_ad_id = \"\";\r\n        console.log(\"wx\" + JSON.stringify(window.wx));\r\n        window.wx.login({});\r\n        this._share_array = ChannelManager.SHARE_CONFIG.share_array;\r\n        this.show_share_menu();\r\n        call();\r\n        return true;\r\n    }\r\n\r\n    private show_share_menu(): boolean {\r\n        console.log(\"WXMiniGame.show_share_menu is begin!\");\r\n        window.wx.showShareMenu({});\r\n        window.wx.onShareAppMessage(() => {\r\n            let share: Share;\r\n            if (0 == this._share_array.length) {\r\n                share = this._default_share;\r\n            } else {\r\n                share = this._share_array[Utils.math_random(true, 0, this._share_array.length)];\r\n            }\r\n\r\n            return {\r\n                title: share.title,\r\n                imageUrl: share.url,\r\n                success: (t) => {\r\n                    console.log(\"转发成功\"), console.log(t);\r\n                },\r\n                fail: (t) => {\r\n                    console.log(\"fail wx onShareAppMessage\" + t);\r\n                }\r\n            }\r\n        });\r\n        console.log(\"WXMiniGame.show_share_menu is end!\");\r\n        return true;\r\n    }\r\n\r\n    public load_sub_packages_env(call: () => void): boolean {\r\n        call();\r\n        return true;\r\n    }\r\n\r\n    public get is_share(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public get is_video_share(): boolean {\r\n        return false;\r\n    }\r\n\r\n    public get_app_name(): string {\r\n        return ChannelManager.APP_WE_CHAT;\r\n    }\r\n\r\n    public vibrate_short(): void {\r\n        if (wx.vibrateShort) {\r\n            wx.vibrateShort({\r\n                success: (t) => {\r\n                    console.log(\"\" + t);\r\n                },\r\n                fail: () => {\r\n                    console.log(\"vibrateShort调用失败\");\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    public vibrate_long(): void {\r\n        if (wx.vibrateLong) {\r\n            wx.vibrateLong({\r\n                success: (t) => {\r\n                    console.log(\"\" + t);\r\n                },\r\n                fail: () => {\r\n                    console.log(\"vibrateLong调用失败\");\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    public get is_rank(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public get is_support_more_game(): boolean {\r\n        return \"ios\" != window.wx.getSystemInfoSync().platform && !!(window.wx.navigateToMiniProgram && window.wx.onNavigateToMiniProgram && window.wx.showMoreGamesModal);\r\n    }\r\n\r\n    public show_more_game(callback: { call: (reS: any, context: number) => void }, context: any): void {\r\n        if (this.is_support_more_game) {\r\n            window.wx.onMoreGamesModalClose((t) => {\r\n                console.log(\"modal closed\", t);\r\n            });\r\n\r\n            window.wx.onNavigateToMiniProgram((t) => {\r\n                console.log(t.errCode);\r\n                console.log(t.errMsg);\r\n            });\r\n\r\n            window.wx.showMoreGamesModal({\r\n                appLaunchOptions: [],\r\n                success: (t) => {\r\n                    console.log(\"success\", t.errMsg);\r\n                    if (callback && context) {\r\n                        callback.call(context, 0);\r\n                    }\r\n                },\r\n                fail: (t) => {\r\n                    console.log(\"fail\", t.errMsg);\r\n                    if (callback && context) {\r\n                        callback.call(context, 1);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    public share_req(callback?: any, context?: any): boolean {\r\n        let share: Share = undefined\r\n        if (0 == this._share_array.length) {\r\n            share = this._default_share;\r\n        } else {\r\n            share = this._share_array[Utils.math_random(!0, 0, this._share_array.length)];\r\n        }\r\n\r\n        if (window.wx.shareAppMessage && share) {\r\n            window.wx.shareAppMessage({\r\n                title: share.title,\r\n                imageUrl: share.url,\r\n                success: (t) => {\r\n                    console.log(\"转发到群的结果\"), console.log(t)\r\n                },\r\n                fail: (t) => {\r\n                    console.log(t)\r\n                }\r\n            });\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private loginReport(): void { }\r\n\r\n    public create_banner_ad(): void {\r\n        if (window.wx) {\r\n            const SystemInfo = window.wx.getSystemInfoSync();\r\n            const windowWidth = SystemInfo.windowWidth;\r\n            const windowHeight = SystemInfo.windowHeight;\r\n\r\n            for (let s = 0; s < this._banner_ad_id_array.length; s++) {\r\n                (() => {\r\n                    const t = s;\r\n                    const banner = this._banner_ad_id_array[t];\r\n                    if (null != banner && \"\" != banner) {\r\n                        const createBannerAd: BannerAd = wx.createBannerAd({\r\n                            adUnitId: banner,\r\n                            adIntervals: 30,\r\n                            style: {\r\n                                width: this._min_banner_ad_width,\r\n                                top: windowHeight,\r\n                                left: (windowWidth - this._min_banner_ad_width) / 2\r\n                            }\r\n                        });\r\n\r\n                        this._banner_ad_array.push(createBannerAd);\r\n                        createBannerAd.onLoad(() => {\r\n                            console.log(\"banner ad id:\" + banner + \" onLoad\");\r\n                            this._banner_ad_loaded_array[t] = true;\r\n                        });\r\n\r\n                        createBannerAd.onResize((t) => {\r\n                            createBannerAd.style.left = (windowWidth - t.width) / 2;\r\n                            createBannerAd.style.top = windowHeight - t.height;\r\n                            console.log(\"banner_ad.onResize:\", t.width, t.height);\r\n\r\n                            const getDevicePixelRatio = cc.view.getDevicePixelRatio();\r\n                            const getScaleX = cc.view.getScaleX();\r\n\r\n                            console.log(\"banner need design size:\", t.width * getDevicePixelRatio / getScaleX, t.height * getDevicePixelRatio / getScaleX);\r\n                        });\r\n\r\n                        createBannerAd.onError((t) => {\r\n                            console.log(t);\r\n                        });\r\n                    }\r\n                })();\r\n            }\r\n        }\r\n    }\r\n\r\n    public show_banner_ad(index: BANNER_AD_TYPE): void {\r\n        if (this._banner_ad_loaded_array[index]) {\r\n            this._banner_ad_flag_array[index] = true;\r\n            const banner = this._banner_ad_array[index];\r\n            banner.show().then(() => {\r\n                if (this._banner_ad_flag_array[index]) {\r\n                    console.log(\"广告显示成功\");\r\n                } else {\r\n                    banner.hide();\r\n                    console.log(\"广告显示慢了，不需要显示了\");\r\n                }\r\n            }).catch((t) => {\r\n                console.log(\"广告组件出现问题\", t);\r\n            })\r\n        }\r\n    }\r\n\r\n    public hide_banner_ad(index: BANNER_AD_TYPE): void {\r\n        if (this._banner_ad_loaded_array[index]) {\r\n            const banner = this._banner_ad_array[index];\r\n            if (banner) {\r\n                banner.hide();\r\n                this._banner_ad_flag_array[index] = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    public create_video_ad(): void {\r\n        if (null != window.wx.createRewardedVideoAd) {\r\n            const SystemInfo = wx.getSystemInfoSync().SDKVersion;\r\n            if (0 <= gm.channel.compare_version(SystemInfo, \"2.8.0\")) {\r\n                console.log(\"该设备支持激励视频广告的多例模式\");\r\n                for (let index = 0; index < this._video_ad_id_array.length; index++) {\r\n                    this._video_ad_array[index] = window.wx.createRewardedVideoAd({\r\n                        adUnitId: this._video_ad_id_array[index],\r\n                        multiton: true\r\n                    });\r\n                    this.on_video_ad_handler(index);\r\n                }\r\n\r\n            } else {\r\n                console.log(\"该设备不支持激励视频广告的多例模式\");\r\n                const index = REWARD_VIDEO_AD_TYPE.ALL;\r\n                this._video_ad_array[index] = window.wx.createRewardedVideoAd({\r\n                    adUnitId: this._video_ad_id_array[index]\r\n                });\r\n                this.on_video_ad_handler(index);\r\n            }\r\n        }\r\n    }\r\n\r\n    private on_video_ad_handler(index: number): void {\r\n        this._video_ad_array[index].onClose((t) => {\r\n            cc.game.resume();\r\n            if (t && t.isEnded || undefined === t) {\r\n                console.log(\"视频广告 正常播放结束\");\r\n                this._video_cb_array[index].apply(this._video_cb_target_array[index]);\r\n            } else {\r\n                console.log(\"视频广告 播放中途退出\");\r\n                gm.ui.show_notice(\"Không có phần thưởng khi kết thúc quảng cáo video\");\r\n            }\r\n        });\r\n\r\n        this._video_ad_array[index].onLoad(() => {\r\n            console.log(\"激励视频 广告加载成功\");\r\n        });\r\n\r\n        this._video_ad_array[index].onError((t) => {\r\n            console.log(t);\r\n        })\r\n    }\r\n\r\n    public show_video_ad(callback: { call: (context: ChannelManager) => void }, context: ChannelManager, type: REWARD_VIDEO_AD_TYPE): void {\r\n        const SystemInfo = wx.getSystemInfoSync().SDKVersion;\r\n        if (gm.channel.compare_version(SystemInfo, \"2.8.0\") < 0) {\r\n            type = REWARD_VIDEO_AD_TYPE.ALL;\r\n        }\r\n        this._video_cb_array[type] = callback;\r\n        this._video_cb_target_array[type] = context;\r\n        if (this._video_ad_array[type]) {\r\n            this._video_ad_array[type].show().then(() => {\r\n                console.log(\"视频广告显示成功\");\r\n                cc.game.pause();\r\n            }).catch(() => {\r\n                console.log(\"自动拉取失败，重新拉取\");\r\n                this._video_ad_array[type].load().then(() => {\r\n                    this._video_ad_array[type].show().then(() => {\r\n                        console.log(\"重新拉取，视频广告显示成功\");\r\n                        cc.game.pause();\r\n                    }).catch((t: { errCode: number }) => {\r\n                        console.log(\"重新拉取失败\", t);\r\n                        if (1004 == t.errCode) {\r\n                            gm.ui.show_notice(\"Quảng cáo khuyến khích video hôm nay đã được sử dụng hết\");\r\n                        } else {\r\n                            gm.ui.show_notice(\"Quảng cáo có thưởng bằng video không mở được\");\r\n                        }\r\n                        gm.channel.share_req(() => {\r\n                            if (callback) {\r\n                                callback.call(context);\r\n                            }\r\n                        }, this);\r\n                    });\r\n                })\r\n            });\r\n\r\n        } else {\r\n            gm.ui.show_notice(\"Quảng cáo được thưởng bằng video chưa được khởi tạo\");\r\n        }\r\n    }\r\n\r\n    create_app_box_ad(): void {\r\n        if (wx.createGridAd) {\r\n            this._app_box = wx.createGridAd({\r\n                adUnitId: this._grid_ad_id,\r\n                adIntervals: 30,\r\n                adTheme: \"white\",\r\n                gridCount: 5,\r\n                style: {\r\n                    left: 0,\r\n                    top: 0,\r\n                    width: 330,\r\n                    opacity: .8\r\n                }\r\n            });\r\n\r\n            this._app_box.onLoad(() => {\r\n                console.log(\"格子广告加载成功\");\r\n            });\r\n\r\n            this._app_box.onError((t) => {\r\n                console.log(t);\r\n            });\r\n        } else {\r\n            console.log(\"不支持格子广告，请升级微信\");\r\n        }\r\n    }\r\n\r\n    public get is_support_app_box(): boolean {\r\n        return !!wx.createGridAd;\r\n    }\r\n\r\n    private show_app_box_ad(): void {\r\n        if (wx.createGridAd) {\r\n            if (this._app_box_loaded && this._app_box) {\r\n                this._app_box.show().catch((t) => {\r\n                    console.error(t);\r\n                });\r\n            } else {\r\n                this.create_app_box_ad();\r\n                console.log(\"_app_box_loaded:\" + this._app_box_loaded);\r\n            }\r\n        } else {\r\n            console.log(\"不支持广告盒子，请升级微信\");\r\n        }\r\n    }\r\n\r\n    private create_interstitial_ad(): void {\r\n        if (wx.createInterstitialAd) {\r\n            this._interstitial_ad = wx.createInterstitialAd({\r\n                adUnitId: this._interstitial_ad_id\r\n            });\r\n\r\n            this._interstitial_ad.onError((t) => {\r\n                console.log(t);\r\n            });\r\n\r\n            this._interstitial_ad.onLoad(() => {\r\n                console.log(\"banner 广告加载成功\");\r\n            });\r\n\r\n            this._interstitial_ad.onLoad(() => {\r\n                this._interstitial_ad_loaded = true;\r\n            });\r\n\r\n            this._interstitial_ad.onClose(() => {\r\n                console.log(\"close event emit\");\r\n            });\r\n\r\n            this._interstitial_ad.onError((t) => {\r\n                console.log(\"error\", t);\r\n            });\r\n        }\r\n    }\r\n\r\n    public get is_support_interstitial_ad(): boolean {\r\n        if (wx.createInterstitialAd) {\r\n            console.log(\"is_support_interstitial_ad: true\");\r\n            return true;\r\n        } else {\r\n            console.log(\"is_support_interstitial_ad: false\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    public show_interstitial_ad(callback: { call: (context: any, num: number) => void }, context: any): void {\r\n        if (this._interstitial_ad && this._interstitial_ad_loaded) {\r\n            this._interstitial_ad.show().catch((t) => {\r\n                console.error(\"show\", t);\r\n                if (callback && context) {\r\n                    callback.call(context, 1);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    public set_rank_value(): void {\r\n        const object = {\r\n            wxgame: {\r\n                score: 0,\r\n                update_time: Math.floor((new Date).getTime() / 1e3)\r\n            },\r\n            cost_time: 0\r\n        };\r\n        console.log(\"WXMINIgame setRankVal data:\", object);\r\n        window.wx.setUserCloudStorage({\r\n            KVDataList: [{\r\n                key: \"level\",\r\n                value: JSON.stringify(object)\r\n            }]\r\n        });\r\n        cc.log(\"上报排行数据\");\r\n    }\r\n\r\n    public get_rank_data(): boolean {\r\n        window.wx.getOpenDataContext().postMessage({\r\n            message: 2\r\n        });\r\n        return true;\r\n    }\r\n\r\n    public set_rank_close(): void {\r\n        window.wx.getOpenDataContext().postMessage({\r\n            message: 99\r\n        });\r\n    }\r\n\r\n    public on_rank_pre_page_click(): void {\r\n        window.wx.getOpenDataContext().postMessage({\r\n            message: 100\r\n        });\r\n    }\r\n\r\n    public on_rank_next_page_click(): void {\r\n        window.wx.getOpenDataContext().postMessage({\r\n            message: 101\r\n        });\r\n    }\r\n\r\n    public get_self_rank_data(): boolean {\r\n        window.wx && window.wx.getOpenDataContext().postMessage({\r\n            message: 300\r\n        });\r\n        return true;\r\n    }\r\n\r\n    public set_self_rank_close(): void {\r\n        window.wx && window.wx.getOpenDataContext().postMessage({\r\n            message: 301\r\n        });\r\n    }\r\n\r\n    public clear_cache(): void {\r\n        if (window.wxDownloader) {\r\n            window.wxDownloader.cleanAllAssets();\r\n            console.log(\"delete cache success\");\r\n        }\r\n    }\r\n}"]}