{"version":3,"sources":["assets\\start-scene\\scripts\\FileSaver.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nconst globalScope: any = \r\n    typeof window !== \"undefined\" && window.window === window\r\n        ? window\r\n        : typeof self !== \"undefined\" && self.self === self\r\n        ? self\r\n        : typeof global !== \"undefined\" && global.global === global\r\n        ? global\r\n        : {};\r\n\r\n\r\nfunction isUrlValid(url: string): boolean {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open(\"HEAD\", url, false);\r\n    try {\r\n        xhr.send();\r\n    } catch (error) {\r\n        console.error(\"Lỗi khi kiểm tra URL:\", error);\r\n        return false;\r\n    }\r\n    return xhr.status >= 200 && xhr.status <= 299;\r\n}\r\n\r\n\r\nfunction triggerClick(element: HTMLElement) {\r\n    try {\r\n        element.dispatchEvent(new MouseEvent(\"click\"));\r\n    } catch (error) {\r\n        const mouseEvent = document.createEvent(\"MouseEvents\");\r\n        mouseEvent.initMouseEvent(\r\n            \"click\", true, true, window, 0,\r\n            0, 0, 80, 20,\r\n            false, false, false, false, 0, null\r\n        );\r\n        element.dispatchEvent(mouseEvent);\r\n    }\r\n}\r\n\r\n\r\nfunction downloadFileFromUrl(url: string, fileName: string, callback?: () => void) {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open(\"GET\", url);\r\n    xhr.responseType = \"blob\";\r\n    xhr.onload = () => handleBlobResponse(xhr.response, fileName, callback);\r\n    xhr.onerror = () => console.error(\"Không thể tải xuống tệp\");\r\n    xhr.send();\r\n}\r\n\r\n\r\nexport function handleBlobResponse(blob: Blob | string, fileName: string, callback?: () => void) {\r\n    const urlCreator = globalScope.URL || globalScope.webkitURL;\r\n    const downloadLink = document.createElement(\"a\");\r\n\r\n    fileName = fileName || \"download\";\r\n    downloadLink.download = fileName;\r\n    downloadLink.rel = \"noopener\";\r\n\r\n    if (typeof blob === \"string\") {\r\n        downloadLink.href = blob;\r\n        if (downloadLink.origin !== location.origin) {\r\n            isUrlValid(downloadLink.href) \r\n                ? downloadFileFromUrl(blob, fileName, callback) \r\n                : triggerClick(downloadLink);\r\n        } else {\r\n            triggerClick(downloadLink);\r\n        }\r\n    } else {\r\n        downloadLink.href = urlCreator.createObjectURL(blob);\r\n        setTimeout(() => urlCreator.revokeObjectURL(downloadLink.href), 40000); // 40s\r\n        setTimeout(() => triggerClick(downloadLink), 0);\r\n    }\r\n}\r\n\r\nglobalScope.saveAs = handleBlobResponse;\r\n"]}