{"version":3,"sources":["assets\\start-scene\\scripts\\LockCloudArea.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// +-+\r\nimport { BuildTypeEnum } from './Constants';\r\nimport { gm } from './GameManager';\r\nimport { NodePoolItem } from './NodePoolItem';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass LockCloudArea extends NodePoolItem {\r\n    @property(cc.Node)\r\n    private barNode: cc.Node | null = null;\r\n\r\n    @property(cc.Label)\r\n    private buildTipsLbl: cc.Label | null = null;\r\n\r\n    @property(cc.Node)\r\n    private lockNode: cc.Node | null = null;\r\n\r\n    @property(cc.Node)\r\n    private rightNode: cc.Node | null = null;\r\n\r\n    private curType: number = 0;\r\n    private buildLvl: number = 0;\r\n\r\n    public initType(type: number): void {\r\n        this.curType = type;\r\n    }\r\n\r\n    protected onEnable(): void {\r\n        gm.ui.on(\"unlock_cloud_refresh\", this.playAnim, this);\r\n        this.node.getComponent(cc.Animation).on(cc.Animation.EventType.FINISHED, this.playAnimEnd, this);\r\n        this.node.position = gm.const.localCloudAreaList[this.curType].pos;\r\n        this.refreshPanel();\r\n    }\r\n\r\n    private playAnim(type: number): void {\r\n        if (type == this.curType) {\r\n            this.node.getComponent(cc.Animation).play();\r\n        }\r\n    }\r\n\r\n    private playAnimEnd(): void {\r\n        gm.pool.put(this.node);\r\n    }\r\n\r\n    public refreshPanel(): void {\r\n        this.buildLvl = gm.data.mapCell_data.getBuildDataByType(BuildTypeEnum.TOWER_TYPE).buildLvl;\r\n        this.barNode.width = Math.min(this.buildLvl / gm.const.localCloudAreaList[this.curType].lvl * 130, 130);\r\n        this.lockNode.active = true;\r\n        this.rightNode.active = false;\r\n\r\n        if (this.buildLvl >= gm.const.localCloudAreaList[this.curType].lvl) {\r\n            this.lockNode.active = false;\r\n            this.rightNode.active = true;\r\n        }\r\n\r\n        this.buildTipsLbl.string = `Lâu đài cấp (${this.buildLvl}/${gm.const.localCloudAreaList[this.curType].lvl})`;\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.ui.off(\"unlock_cloud_refresh\", this.playAnim, this);\r\n        this.node.getComponent(cc.Animation).off(cc.Animation.EventType.FINISHED, this.playAnimEnd, this);\r\n    }\r\n\r\n    private onClickBuild(): void {\r\n        gm.ui.set_module_args(gm.const.UNLOCKAREACLOUDOP.key, this.curType);\r\n        gm.ui.async_show_module(gm.const.UNLOCKAREACLOUDOP);\r\n    }\r\n}\r\n\r\nexport default LockCloudArea;"]}