{"version":3,"sources":["assets\\start-scene\\scripts\\Launch.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// @\r\nimport { ReportData } from \"./NetUtils\";\r\n\r\n// @\r\nexport enum LoadingState {\r\n    START = 0,\r\n    START_FULL = 1,\r\n    CAVES_FULL = 2,\r\n    REWARD_FULL = 3,\r\n    BOAT_OUT = 4,\r\n    BOAT_IN = 5,\r\n    COMPLETE = 6,\r\n}\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n//\r\n@ccclass(\"Launch\")\r\nexport class Launch extends cc.Component {\r\n    // @\r\n    private static _instance: Launch = null;\r\n\r\n    // @\r\n    @property(cc.Node)\r\n    private bg_node: cc.Node = null;\r\n\r\n    // (not used) ???\r\n    @property(cc.Node)\r\n    protected notice_node: cc.Node = null;\r\n\r\n    // (not used) ???\r\n    @property(cc.RichText)\r\n    protected notice_txt: cc.RichText = null;\r\n\r\n    // (not used) ???\r\n    @property(cc.Label)\r\n    protected prompt_lbl: cc.Label = null;\r\n\r\n    @property(cc.ProgressBar)\r\n    private bar_node: cc.ProgressBar | null = null;\r\n\r\n    @property(cc.ProgressBar)\r\n    private bar_node_2: cc.ProgressBar | null = null;\r\n\r\n    // @\r\n    private _low_speed: number;\r\n    private _low_speed_2: number;\r\n    private _total_len: number;\r\n    private _total_len_2: number;\r\n    private _high_speed: number;\r\n    private _state: LoadingState;\r\n\r\n    // @\r\n    private constructor() {\r\n        super();\r\n        this._low_speed = 20;\r\n        this._low_speed_2 = 100;\r\n        this._total_len = 0;\r\n        this._total_len_2 = 0;\r\n        this._high_speed = 500;\r\n        // this._state = LoadingState.START\r\n    }\r\n\r\n    public static get instance(): Launch {\r\n        if (this._instance === null) {\r\n            console.error(\"Call after the singleton is instantiated\");\r\n        }\r\n        return this._instance!;\r\n    }\r\n\r\n    protected onLoad(): void {\r\n        Launch._instance = this;\r\n        cc.director.once(\r\n            cc.Director.EVENT_AFTER_DRAW,\r\n            () => {\r\n                this.scheduleOnce(() => {\r\n                    this.after_first_draw();\r\n                });\r\n            },\r\n            this\r\n        );\r\n        cc.game.on(cc.game.EVENT_HIDE, this.on_game_hide, this);\r\n        cc.game.on(cc.game.EVENT_SHOW, this.on_game_show, this);\r\n    }\r\n\r\n    private after_first_draw(): void {\r\n        ReportData.instance.report_once_point(10010);\r\n        this.state = LoadingState.START;\r\n        cc.Canvas.instance.node.addComponent(\"GameMain\");\r\n    }\r\n\r\n    protected onDestroy(): void {\r\n        cc.game.off(cc.game.EVENT_HIDE, this.on_game_hide, this);\r\n        cc.game.off(cc.game.EVENT_SHOW, this.on_game_show, this);\r\n    }\r\n\r\n    private on_game_hide(): void {\r\n        cc.log(\"Switch to the background and pause the game\");\r\n        cc.game.pause();\r\n    }\r\n\r\n    private on_game_show(): void {\r\n        cc.log(\"Switch to the background and resume the game\");\r\n        cc.game.resume();\r\n    }\r\n\r\n    public get state(): LoadingState {\r\n        return this._state;\r\n    }\r\n\r\n    public set state(value: LoadingState) {\r\n        if (this._state !== value) {\r\n            this._state = value;\r\n        }\r\n        if (value === LoadingState.COMPLETE) {\r\n            this.bg_node!.active = false;\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number): void {\r\n        if (this._state === LoadingState.COMPLETE) {\r\n            this._total_len += deltaTime * this._high_speed;\r\n            this._total_len_2 += deltaTime * this._high_speed;\r\n            this.bar_node!.progress = Math.floor(this._total_len) / 100;\r\n            this.bar_node_2!.progress = (this._total_len_2 % 100) / 100;\r\n            if (this._total_len >= 100) {\r\n                this.bg_node!.active = false;\r\n            }\r\n            /* if (cc.sys.platform === cc.sys.OPPO_GAME) {\r\n                qg.setLoadingProgress({ progress: this._total_len });\r\n            } */\r\n        } else {\r\n            if (this._total_len < 90) {\r\n                this._total_len += deltaTime * this._low_speed;\r\n                this.bar_node!.progress = Math.floor(this._total_len) / 100;\r\n            }\r\n            this._total_len_2 += deltaTime * this._low_speed_2;\r\n            this.bar_node_2!.progress = (this._total_len_2 % 100) / 100;\r\n        }\r\n    }\r\n}\r\n"]}