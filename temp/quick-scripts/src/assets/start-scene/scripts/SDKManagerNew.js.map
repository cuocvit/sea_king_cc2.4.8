{"version":3,"sources":["assets\\start-scene\\scripts\\SDKManagerNew.ts"],"names":[],"mappings":";;;;;;;AACA;IAiBI;QAZQ,qCAAgC,GAAG,KAAK,CAAC;QACzC,kBAAa,GAAG,KAAK,CAAC;IAa9B,CAAC;IAVa,sBAAQ,GAAtB;QACI,IAAI,IAAI,IAAI,IAAI,CAAC,SAAS,EAAE;YACxB,IAAI,CAAC,SAAS,GAAG,IAAI,aAAa,CAAC;SACtC;QACD,OAAO,IAAI,CAAC,SAAS,CAAA;IACzB,CAAC;IAOO,iDAAyB,GAAjC,UAAkC,UAAkB,EAAE,UAAkB,EAAE,KAAkB,EAAE,MAAmB;QAC7G,IAAM,IAAI,GAAG,EAAE,CAAA;QACf,KAAK,IAAI,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE;YACnD,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;SACtC;QACD,IAAM,YAAY,GAAa,EAAE,CAAC;QAClC,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE;YAChC,IAAI,eAAe,GAAG,GAAG,CAAC;YAC1B,IAAM,YAAY,GAAa,EAAE,CAAC;YAElC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAClC,IAAM,OAAO,GAAG,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC/B,IAAI,UAAU,IAAI,OAAO,EAAE;oBACvB,IAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oBACpB,IAAI,EAAE,IAAI,GAAG,CAAC,IAAI,EAAE;wBAChB,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;4BACxC,CAAC,aAAa,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;yBACrD;wBACD,YAAY,CAAC,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;qBAC7C;yBAAM;wBACH,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;qBACvB;iBACJ;qBAAM;oBACH,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;iBAC9B;gBACD,eAAe,IAAI,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;gBACvD,eAAe,IAAI,GAAG,GAAG,IAAI,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;aACnE;YAED,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YACjD,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC9B,YAAY,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YACnC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SAE7B;aAAM;YACH,IAAI,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE;gBAC5B,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;gBACxB,OAAO;aACV;YACD,YAAY,CAAC,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YACjD,IAAI,kBAAkB,GAAG,aAAa,CAAC,eAAe,CAAC;YACvD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAClC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC3B,kBAAkB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,GAAG,GAAG,CAAC;aACxD;YACD,YAAY,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YACtC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,CAAA;SAC5B;QAED,OAAO,CAAC,GAAG,CAAC,iBAAiB,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC9D,OAAO,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,EAAE,YAAY,CAAC,CAAA;IAC9E,CAAC;IAEO,6CAAqB,GAA7B,UAA8B,IAAY;QACtC,IAAI,SAAS,IAAI,IAAI,EAAE;YACnB,OAAO,GAAG,CAAC;SACd;aAAM,IAAI,QAAQ,IAAI,IAAI,EAAE;YACzB,OAAO,oBAAoB,CAAC;SAC/B;aAAM,IAAI,QAAQ,IAAI,IAAI,EAAE;YACzB,OAAO,GAAG,CAAC;SACd;aAAM,IAAI,MAAM,IAAI,IAAI,EAAE;YACvB,OAAO,GAAG,CAAC;SACd;aAAM,IAAI,UAAU,IAAI,IAAI,EAAE;YAC3B,OAAO,oBAAoB,CAAC;SAC/B;aAAM;YACH,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;YAC1B,OAAO,EAAE,CAAC;SACb;IACL,CAAC;IAEO,sCAAc,GAAtB,UAAuB,UAAkB;QACrC,OAAO,CAAC,GAAG,CAAC,iBAAiB,GAAG,UAAU,CAAC,CAAC;QAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QAC5C,IAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;QAC9C,IAAI,MAAM,EAAE;YACR,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;SAC3C;aAAM;YACH,EAAE,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;SACtC;IACL,CAAC;IAEO,4BAAI,GAAZ,cAAiB,CAAC;IAEV,wCAAgB,GAAxB,cAA6B,CAAC;IAEtB,4CAAoB,GAA5B;QACI,IAAI,CAAC,yBAAyB,CAC1B,MAAM,EACN,mBAAmB,EACnB,IAAI,CAAC,wCAAwC,EAC7C,IAAI,CAAC,qCAAqC,CAC7C,CAAC;IACN,CAAC;IAEO,gEAAwC,GAAhD;QACI,IAAI,CAAC,gCAAgC,GAAG,IAAI,CAAC;IACjD,CAAC;IAEO,6DAAqC,GAA7C;QACI,IAAI,CAAC,gCAAgC,GAAG,KAAK,CAAC;IAClD,CAAC;IAEO,4CAAoB,GAA5B;QACI,IAAI,IAAI,CAAC,gCAAgC,EAAE;YACvC,IAAI,CAAC,yBAAyB,CAC1B,MAAM,EACN,mBAAmB,EACnB,IAAI,CAAC,oCAAoC,EACzC,IAAI,CAAC,kCAAkC,CAC1C,CAAC;SACL;IACL,CAAC;IAEO,4DAAoC,GAA5C,cAAiD,CAAC;IAC1C,0DAAkC,GAA1C,cAA+C,CAAC;IACxC,sCAAc,GAAtB,cAA2B,CAAC;IACpB,sCAAc,GAAtB,cAA2B,CAAC;IAEpB,yCAAiB,GAAzB,UAA0B,IAAgB;QACtC,IAAI,CAAC,yBAAyB,CAC1B,QAAQ,EACR,aAAa,EACb,IAAI,CAAC,6BAA6B,CACrC,CAAC;QACF,OAAO,CAAC,GAAG,CAAC,iCAAiC,CAAC,CAAC;QAC/C,IAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC;QACzC,IAAI,MAAM,CAAC,GAAG,EAAE;YACZ,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,mBAAmB,EAAE,KAAK,CAAC,CAAC;SACtG;IACL,CAAC;IAEO,6CAAqB,GAA7B;QACI,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;QACnD,IAAI,CAAC,CAAC,MAAM,CAAC,GAAG,EAAE;YACd,OAAO,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,uBAAuB,EAAE,KAAK,CAAC,CAAC;SACjH;IACL,CAAC;IAEO,qDAA6B,GAArC;QACI,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC;QAC3D,IAAI,IAAI,CAAC,4BAA4B,EAAE;YACnC,IAAI,CAAC,4BAA4B,EAAE,CAAC;YACpC,OAAO,CAAC,GAAG,CAAC,4CAA4C,CAAC,CAAC;SAC7D;IACL,CAAC;IAEO,oCAAY,GAApB;QACI,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;QAC1C,IAAI,MAAM,CAAC,GAAG,EAAE;YACZ,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;SACjG;IACL,CAAC;IAEO,oCAAY,GAApB;QACI,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;QAC1C,IAAI,MAAM,CAAC,GAAG,EAAE;YACZ,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;SACjG;IACL,CAAC;IAGO,mCAAW,GAAnB;QACI,OAAO,CAAC,GAAG,CAAC,2BAA2B,CAAC,CAAC;QACzC,IAAI,MAAM,CAAC,GAAG,EAAE;YACZ,OAAO,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,aAAa,EAAE,sBAAsB,CAAC,CAAC;SACxH;aAAM;YACH,OAAO,OAAO,CAAC;SAClB;IACL,CAAC;IAEO,kCAAU,GAAlB;QACI,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;QACxC,IAAI,MAAM,CAAC,GAAG,EAAE;YACZ,OAAO,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,YAAY,EAAE,sBAAsB,CAAC,CAAC;SACvH;aAAM;YACH,OAAO,SAAS,CAAC;SACpB;IACL,CAAC;IAEO,sCAAc,GAAtB;QACI,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;QAC5C,IAAI,MAAM,CAAC,GAAG,EAAE;YACZ,OAAO,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,qCAAqC,EAAE,gBAAgB,EAAE,sBAAsB,CAAC,CAAC;SAC3H;aAAM;YACH,OAAO,SAAS,CAAC;SACpB;IACL,CAAC;IA9Mc,uBAAS,GAAyB,IAAI,CAAC;IACvC,2BAAa,GAA6B,EAAE,CAAC;IAC7C,6BAAe,GAAG,uCAAuC,CAAC;IA6M7E,oBAAC;CAhND,AAgNC,IAAA;AAEQ,sCAAa;AACrB,MAAc,CAAC,aAAa,GAAG,aAAa,CAAC,QAAQ,CAAC","file":"","sourceRoot":"/","sourcesContent":["\r\nclass SDKManagerNew {\r\n    private static _instance: SDKManagerNew | null = null;\r\n    private static _callback_map: Record<string, Function> = {};\r\n    private static java_class_name = \"org/cocos2dx/javascript/SDKManagerNew\";\r\n\r\n    private _is_load_reward_video_ad_success = false;\r\n    private isInitSuccess = false;\r\n    private _rewardVideoAdRewardCallback?: () => void;\r\n\r\n    public static instance(): SDKManagerNew {\r\n        if (null == this._instance) {\r\n            this._instance = new SDKManagerNew;\r\n        }\r\n        return this._instance\r\n    }\r\n\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    private call_native_static_method(returnType: string, methodName: string, call1?: () => void, clall2?: () => void): any {\r\n        const args = []\r\n        for (let index = 2; index < arguments.length; index++) {\r\n            args[index - 2] = arguments[index];\r\n        }\r\n        const nativeParams: string[] = [];\r\n        if (cc.sys.os == cc.sys.OS_ANDROID) {\r\n            let methodSignature = \"(\";\r\n            const callbackArgs: string[] = [];\r\n\r\n            for (let s = 0; s < args.length; s++) {\r\n                const argType = typeof args[s];\r\n                if (\"function\" == argType) {\r\n                    const arg = args[s];\r\n                    if (\"\" != arg.name) {\r\n                        if (!SDKManagerNew._callback_map[arg.name]) {\r\n                            (SDKManagerNew._callback_map[arg.name] = args[s]);\r\n                        }\r\n                        callbackArgs.push(\"callback@\" + arg.name);\r\n                    } else {\r\n                        cc.error(\"函数名不能为空\");\r\n                    }\r\n                } else {\r\n                    callbackArgs.push(args[s]);\r\n                }\r\n                methodSignature += this.type_to_platform_flag(argType);\r\n                methodSignature += \")\" + this.type_to_platform_flag(returnType);\r\n            }\r\n\r\n            nativeParams.push(SDKManagerNew.java_class_name);\r\n            nativeParams.push(methodName);\r\n            nativeParams.push(methodSignature);\r\n            nativeParams.concat(args);\r\n\r\n        } else {\r\n            if (cc.sys.os != cc.sys.OS_IOS) {\r\n                console.error(\"不支持的平台\");\r\n                return;\r\n            }\r\n            nativeParams.push(SDKManagerNew.java_class_name);\r\n            let iosMethodSignature = SDKManagerNew.java_class_name;\r\n            for (let s = 0; s < args.length; s++) {\r\n                nativeParams.push(args[s]);\r\n                iosMethodSignature += 0 == s ? \":\" : \"arg\" + s + \":\";\r\n            }\r\n            nativeParams.push(iosMethodSignature);\r\n            nativeParams.concat(args)\r\n        }\r\n\r\n        console.log(\"js call native \" + JSON.stringify(nativeParams));\r\n        return jsb.reflection.callStaticMethod.apply(jsb.reflection, nativeParams)\r\n    }\r\n\r\n    private type_to_platform_flag(type: string): string {\r\n        if (\"boolean\" == type) {\r\n            return \"Z\";\r\n        } else if (\"string\" == type) {\r\n            return \"Ljava/lang/String;\";\r\n        } else if (\"number\" == type) {\r\n            return \"I\";\r\n        } else if (\"void\" == type) {\r\n            return \"V\";\r\n        } else if (\"function\" == type) {\r\n            return \"Ljava/lang/String;\";\r\n        } else {\r\n            console.error(\"不支持的参数类型\");\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    private native_call_js(jsonString: string): void {\r\n        console.log(\"native call js \" + jsonString);\r\n        const callbackData = JSON.parse(jsonString);\r\n        const method = this[callbackData.method_name];\r\n        if (method) {\r\n            method.apply(this, callbackData.params);\r\n        } else {\r\n            cc.error(\"SDKManagerNew中没有找到回调函数\");\r\n        }\r\n    }\r\n\r\n    private init() { }\r\n\r\n    private on_init_callback() { }\r\n\r\n    private load_reward_video_ad(): void {\r\n        this.call_native_static_method(\r\n            \"void\",\r\n            \"loadRewardVideoAd\",\r\n            this.on_load_reward_video_ad_success_callback,\r\n            this.on_load_reward_video_ad_fail_callback\r\n        );\r\n    }\r\n\r\n    private on_load_reward_video_ad_success_callback(): void {\r\n        this._is_load_reward_video_ad_success = true;\r\n    }\r\n\r\n    private on_load_reward_video_ad_fail_callback(): void {\r\n        this._is_load_reward_video_ad_success = false;\r\n    }\r\n\r\n    private show_reward_video_ad(): void {\r\n        if (this._is_load_reward_video_ad_success) {\r\n            this.call_native_static_method(\r\n                \"void\",\r\n                \"showRewardVideoAd\",\r\n                this.on_reward_video_ad_complete_callback,\r\n                this.on_reward_video_ad_cancel_callback\r\n            );\r\n        }\r\n    }\r\n\r\n    private on_reward_video_ad_complete_callback() { }\r\n    private on_reward_video_ad_cancel_callback() { }\r\n    private show_banner_ad() { }\r\n    private hide_banner_ad() { }\r\n\r\n    private showRewardVideoAd(call: () => void): void {\r\n        this.call_native_static_method(\r\n            \"string\",\r\n            \"method_name\",\r\n            this.onRewardVideoAdRewardCallback\r\n        );\r\n        console.log(\"SDKManagerNew:showRewardVideoAd\");\r\n        this._rewardVideoAdRewardCallback = call;\r\n        if (window.jsb) {\r\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"showRewardVideoAd\", \"()V\");\r\n        }\r\n    }\r\n\r\n    private isRewardVideoAdLoaded(): void {\r\n        console.log(\"SDKManagerNew:isRewardVideoAdLoaded\");\r\n        if (!!window.jsb) {\r\n            return jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"isRewardVideoAdLoaded\", \"()Z\");\r\n        }\r\n    }\r\n\r\n    private onRewardVideoAdRewardCallback(): void {\r\n        console.log(\"SDKManagerNew:onRewardVideoAdRewardCallback\");\r\n        if (this._rewardVideoAdRewardCallback) {\r\n            this._rewardVideoAdRewardCallback();\r\n            console.log(\"SDKManagerNew:_rewardVideoAdRewardCallback\");\r\n        }\r\n    }\r\n\r\n    private showBannerAd(): void {\r\n        console.log(\"SDKManagerNew:showBannerAd\");\r\n        if (window.jsb) {\r\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"showBannerAd\", \"()V\");\r\n        }\r\n    }\r\n\r\n    private hideBannerAd(): void {\r\n        console.log(\"SDKManagerNew:hideBannerAd\");\r\n        if (window.jsb) {\r\n            jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"hideBannerAd\", \"()V\");\r\n        }\r\n    }\r\n\r\n\r\n    private getLanguage(): string | any {\r\n        console.log(\"SDKManagerNew:getLanguage\");\r\n        if (window.jsb) {\r\n            return jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"getLanguage\", \"()Ljava/lang/String;\");\r\n        } else {\r\n            return \"zh-CN\";\r\n        }\r\n    }\r\n\r\n    private getAppName(): string | any {\r\n        console.log(\"SDKManagerNew:getAppName\");\r\n        if (window.jsb) {\r\n            return jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"getAppName\", \"()Ljava/lang/String;\");\r\n        } else {\r\n            return \"unknown\";\r\n        }\r\n    }\r\n\r\n    private getVersionName(): string | any {\r\n        console.log(\"SDKManagerNew:getVersionName\");\r\n        if (window.jsb) {\r\n            return jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"getVersionName\", \"()Ljava/lang/String;\");\r\n        } else {\r\n            return \"unknown\";\r\n        }\r\n    }\r\n}\r\n\r\nexport { SDKManagerNew };\r\n(window as any).SDKManagerNew = SDKManagerNew.instance;"]}