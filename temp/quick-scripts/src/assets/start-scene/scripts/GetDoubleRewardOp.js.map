{"version":3,"sources":["assets\\start-scene\\scripts\\GetDoubleRewardOp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// +-+\r\nimport { gm } from './GameManager';\r\nimport { Utils } from './Utils';\r\nimport { BundleName, RewardIdEnum, SetItemNumEnum } from './Constants';\r\nimport { BANNER_AD_TYPE } from './ChannelManager';\r\nimport { ReportData } from './NetUtils';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\nexport interface DoubleOp {\r\n    type: number;\r\n    idList: number[];\r\n    numList: number[];\r\n}\r\n\r\n\r\n@ccclass\r\nclass GetDoubleRewardOp extends cc.Component {\r\n    @property([cc.Node])\r\n    private photoList: cc.Node[] = [];\r\n\r\n    @property(cc.Label)\r\n    private lblTitle: cc.Label | null = null;\r\n\r\n    @property(cc.Label)\r\n    private lblbtn: cc.Label | null = null;\r\n\r\n    private curType: number = 0;\r\n    private idList: number[] = [];\r\n    private numList: number[] = [];\r\n    private CURTIMES: number = 10;\r\n\r\n    protected onEnable(): void {\r\n        const moduleData = gm.ui.get_module_args(gm.const.GETDOUBLEOP.key) as DoubleOp;\r\n        this.curType = moduleData.type;\r\n        this.idList = moduleData.idList;\r\n        this.numList = moduleData.numList;\r\n        this.lblTitle.string = this.curType == 2 ? \"Quà linh hồn\" : \"Quà nhận được\";\r\n        this.lblbtn.string = this.curType == 2 ? \"Nhận ngay\" : \"Nhận gấp \"+ this.CURTIMES;\r\n        this.photoList[0].x = this.idList.length <= 1 ? 0 : -80;\r\n\r\n        for (let a = 0; a < this.photoList.length; a++) {\r\n            this.photoList[a].active = false;\r\n            if (this.idList.length > a) {\r\n                this.photoList[a].active = true;\r\n                if (this.idList[a] > 30000) {\r\n                    const event = gm.data.config_data.getHeroCfgByID(this.idList[a]);\r\n                    if (event) {\r\n                        Utils.async_set_sprite_frame(this.photoList[a].children[0].getComponent(cc.Sprite), BundleName.COMMON, \"res/color_\" + event.lv);\r\n                        Utils.async_set_sprite_frame(this.photoList[a].children[1].getComponent(cc.Sprite), BundleName.COMMON, \"res/handbook/\" + event.icon);\r\n                    }\r\n                } else {\r\n                    const event = gm.data.config_data.getItemCfgByID(this.idList[a]);\r\n                    if (event) {\r\n                        Utils.async_set_sprite_frame(this.photoList[a].children[0].getComponent(cc.Sprite), BundleName.COMMON, \"res/color_\" + (event.lv == 0 ? 1 : event.lv));\r\n                        if ([11002, 11003, 11006].includes(event.id)) {\r\n                            Utils.async_set_sprite_frame(this.photoList[a].children[1].getComponent(cc.Sprite), BundleName.MAP, \"res/rewardIcon/\" + event.icon);\r\n                        } else {\r\n                            Utils.async_set_sprite_frame(this.photoList[a].children[1].getComponent(cc.Sprite), BundleName.COMMON, \"res/handbook/\" + event.icon);\r\n                        }\r\n                    }\r\n                }\r\n                this.photoList[a].children[2].getComponent(cc.Label).string = \"x\" + this.numList[a];\r\n            }\r\n        }\r\n        gm.channel.show_banner_ad(BANNER_AD_TYPE.ALL);\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.channel.hide_banner_ad(BANNER_AD_TYPE.ALL);\r\n    }\r\n\r\n    private onClickClose(): void {\r\n        gm.ui.async_hide_module(gm.const.GETDOUBLEOP);\r\n    }\r\n\r\n    private onClickDoubleItem(): void {\r\n        gm.channel.show_video_ad(this.getDoubleCb, this);\r\n    }\r\n\r\n    private getDoubleCb(): void {\r\n        if (this.curType == 2) {\r\n            gm.data.mapCell_data.splitItemNum(this.numList[0], 22008, 1);\r\n            gm.data.mapCell_data.async_write_data();\r\n            gm.channel.report_event(\"video_get_soul\", {\r\n                event_desc: \"看视频注魂的人数\",\r\n                desc: \"看视频注魂的人数\",\r\n                hero_id: 1\r\n            });\r\n            ReportData.instance.report_once_point(10891);\r\n            ReportData.instance.report_point(10892);\r\n        } else {\r\n            const listNum: number[] = [];\r\n            for (let e = 0; e < this.idList.length; e++) {\r\n                if (this.idList[e] == RewardIdEnum.GOLD) {\r\n                    gm.data.mapCell_data.setAddGameCoin(SetItemNumEnum.ADD_ITEM_TYPE, this.numList[e] * this.CURTIMES);\r\n                    gm.ui.show_coin_fly(this.idList[e], this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n                } else if (this.idList[e] == RewardIdEnum.DIAMOND) {\r\n                    gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.ADD_ITEM_TYPE, this.numList[e] * this.CURTIMES);\r\n                    gm.ui.show_coin_fly(this.idList[e], this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n                } else if (this.idList[e] == RewardIdEnum.BARREL) {\r\n                    gm.data.mapCell_data.addBarrelNum(this.numList[e] * this.CURTIMES);\r\n                    gm.ui.show_coin_fly(RewardIdEnum.BARREL, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO), this.numList[e] * this.CURTIMES, gm.ui.mapMainUI.barrelNode.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n                } else {\r\n                    const num = this.numList[e] * this.CURTIMES;\r\n                    for (let i = 0; i < num; i++) {\r\n                        listNum.push(this.idList[e]);\r\n                    }\r\n                }\r\n            }\r\n            if (listNum.length > 0) {\r\n                gm.data.mapCell_data.addWareHouseList(listNum);\r\n                gm.data.mapCell_data.async_write_data();\r\n                ReportData.instance.report_once_point(10803);\r\n                ReportData.instance.report_point(10804);\r\n            }\r\n        }\r\n        gm.ui.async_hide_module(gm.const.GETDOUBLEOP);\r\n    }\r\n}\r\n\r\nexport default GetDoubleRewardOp;"]}