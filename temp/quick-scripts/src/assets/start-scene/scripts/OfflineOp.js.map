{"version":3,"sources":["assets\\start-scene\\scripts\\OfflineOp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// +-+\r\nimport { gm } from './GameManager';\r\nimport { Utils } from './Utils';\r\nimport { BundleName, RewardIdEnum, SetItemNumEnum } from './Constants';\r\nimport { BANNER_AD_TYPE } from './ChannelManager';\r\nimport { ReportData } from './NetUtils';\r\nimport { GameModule } from './GameModule';\r\nimport { TempData } from './TempData';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass OfflineOp extends GameModule {\r\n    @property([cc.Node])\r\n    private photoList: cc.Node[] = [];\r\n\r\n    @property(cc.Label)\r\n    private lblTime: cc.Label | null = null;\r\n\r\n    private idList: number[] = [11006, 11002, 16001, 17001];\r\n    private numList: number[] = [1, 5, 3, 2];\r\n    private CURTIMES: number = 5;\r\n\r\n    protected onEnable(): void {\r\n        const offlineTime: number = TempData.offline_time;\r\n        const timeMultiplier: number = Math.floor(Math.min(offlineTime, 3600) / 600);\r\n\r\n        for (let index: number = 0; index < this.numList.length; index++) {\r\n            this.numList[index] = this.numList[index] * timeMultiplier;\r\n        }\r\n\r\n        this.lblTime.string = \"Thời gian ngoại tuyến: \" + Utils.format_time(offlineTime);\r\n        for (let index: number = 0; index < this.photoList.length; index++) {\r\n            this.photoList[index].active = false;\r\n            if (this.idList.length > index) {\r\n                this.photoList[index].active = true;\r\n                const itemConfig = gm.data.config_data.getItemCfgByID(this.idList[index]);\r\n                if (itemConfig) {\r\n                    Utils.async_set_sprite_frame(this.photoList[index].children[0].getComponent(cc.Sprite), BundleName.COMMON, \"res/color_\" + (itemConfig.lv === 0 ? 1 : itemConfig.lv));\r\n                    Utils.async_set_sprite_frame(this.photoList[index].children[1].getComponent(cc.Sprite), BundleName.MAP, \"res/rewardIcon/\" + itemConfig.icon);\r\n                }\r\n                this.photoList[index].children[2].getComponent(cc.Label).string = \"x\" + this.numList[index];\r\n            }\r\n        }\r\n        gm.channel.show_banner_ad(BANNER_AD_TYPE.ALL);\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.channel.hide_banner_ad(BANNER_AD_TYPE.ALL);\r\n    }\r\n\r\n    private onClickOneGet(): void {\r\n        this.getDoubleCb(1);\r\n    }\r\n\r\n    private onClickDoubleItem(): void {\r\n        ReportData.instance.report_once_point(10529);\r\n        ReportData.instance.report_point(10530);\r\n        gm.channel.show_video_ad(this.getDoubleCb, this);\r\n    }\r\n\r\n    private getDoubleCb(multiplier: number = 5): void {\r\n        if (multiplier == 5) {\r\n            ReportData.instance.report_once_point(10629);\r\n            ReportData.instance.report_point(10630);\r\n        }\r\n\r\n        for (let index = 0; index < this.idList.length; index++) {\r\n            if (this.idList[index] == RewardIdEnum.GOLD) {\r\n                gm.data.mapCell_data.setAddGameCoin(SetItemNumEnum.ADD_ITEM_TYPE, this.numList[index] * multiplier);\r\n                gm.ui.show_coin_fly(RewardIdEnum.GOLD, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO))\r\n            } else if (this.idList[index] == RewardIdEnum.DIAMOND) {\r\n                gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.ADD_ITEM_TYPE, this.numList[index] * multiplier);\r\n                gm.ui.show_coin_fly(RewardIdEnum.DIAMOND, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO))\r\n            } else if (this.idList[index] == RewardIdEnum.BARREL) {\r\n                gm.data.mapCell_data.addBarrelNum(this.numList[index] * multiplier);\r\n                gm.ui.show_coin_fly(RewardIdEnum.BARREL, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO), 0, gm.ui.mapMainUI.barrelNode.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n            } else if (!(16001 != this.idList[index] && 17001 != this.idList[index])) {\r\n                const splitRewardId = 16001 == this.idList[index] ? 16008 : 17008;\r\n                gm.data.mapCell_data.splitItemNum(this.numList[index] * multiplier, splitRewardId, 1);\r\n            }\r\n        }\r\n        gm.ui.async_hide_module(gm.const.OFFLINEOP)\r\n    }\r\n}\r\n\r\nexport default OfflineOp;"]}