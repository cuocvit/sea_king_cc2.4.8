{"version":3,"sources":["assets\\start-scene\\scripts\\BuyBarrelOp.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// +-+\r\nimport { gm } from './GameManager';\r\nimport { SetItemNumEnum } from './Constants';\r\nimport { ReportData } from './NetUtils';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass BuyBarrelPanel extends cc.Component {\r\n    @property([cc.Label])\r\n    private barrelNumList: cc.Label[] = [];\r\n\r\n    @property([cc.Label])\r\n    private coinNumList: cc.Label[] = [];\r\n\r\n    private _barrelNumList: { barrelNum: number; coin: number }[] = [\r\n        { barrelNum: 40, coin: 33 },\r\n        { barrelNum: 70, coin: 66 },\r\n        { barrelNum: 110, coin: 99 }\r\n    ];\r\n\r\n    protected onEnable(): void {\r\n        for (let t = 0; t < this._barrelNumList.length; t++) {\r\n            this.barrelNumList[t].string = this._barrelNumList[t].barrelNum.toString();\r\n            if (t != 0) {\r\n                this.coinNumList[t].string = this._barrelNumList[t].coin.toString();\r\n            }\r\n        }\r\n    }\r\n\r\n    private onClickBuy(event: cc.Event, index: string): void {\r\n        const number: number = parseInt(index);\r\n        if (number != 0) {\r\n            if (gm.data.mapCell_data.roleCoinData.diamondNum < this._barrelNumList[number].coin) {\r\n                gm.ui.set_module_args(gm.const.GETCOINOP.key, true);\r\n                gm.ui.show_panel(gm.const.GETCOINOP);\r\n            } else {\r\n                gm.data.mapCell_data.diamond_buy_barrel_times++;\r\n                gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.REDUCE_ITEM_TYPE, this._barrelNumList[number].coin);\r\n                gm.data.mapCell_data.addBarrelNum(this._barrelNumList[number].barrelNum);\r\n                this.onClosePanel();\r\n                if (number == 1) {\r\n                    ReportData.instance.report_point(10303);\r\n                    ReportData.instance.report_once_point(10304);\r\n                } else if (number == 2) {\r\n                    ReportData.instance.report_point(10305);\r\n                    ReportData.instance.report_once_point(10306);\r\n                }\r\n                gm.channel.report_event(\"diamond_buy_barrel\", {\r\n                    event_desc: \"钻石购买木桶\",\r\n                    buy_count: gm.data.mapCell_data.diamond_buy_barrel_times,\r\n                    task_desc: cc.js.formatStr(\"购买木桶%d次\", gm.data.mapCell_data.diamond_buy_barrel_times)\r\n                });\r\n            }\r\n        } else {\r\n            this.onClickWatchAd();\r\n        }\r\n    }\r\n\r\n    private onClickWatchAd(): void {\r\n        gm.channel.show_video_ad(this.watchAdCb, this);\r\n    }\r\n\r\n    private watchAdCb(): void {\r\n        gm.data.mapCell_data.watch_ad_buy_barrel_times++;\r\n        gm.data.mapCell_data.addBarrelNum(this._barrelNumList[0].barrelNum);\r\n        this.onClosePanel();\r\n        ReportData.instance.report_point(10301);\r\n        ReportData.instance.report_once_point(10302);\r\n        gm.channel.report_event(\"video_buy_barrel\", {\r\n            event_desc: \"看视频购买木桶\",\r\n            buy_count: gm.data.mapCell_data.watch_ad_buy_barrel_times,\r\n            task_desc: cc.js.formatStr(\"购买木桶%d次\", gm.data.mapCell_data.watch_ad_buy_barrel_times)\r\n        });\r\n    }\r\n\r\n    private onClosePanel(): void {\r\n        gm.ui.async_hide_module(gm.const.BUYBARRELOP);\r\n    }\r\n}\r\n\r\nexport default BuyBarrelPanel;"]}