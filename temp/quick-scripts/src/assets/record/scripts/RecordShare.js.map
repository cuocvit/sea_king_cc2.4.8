{"version":3,"sources":["assets\\record\\scripts\\RecordShare.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { RecordData } from '../../start-scene/scripts/RecordData';\r\nimport { gm } from '../../start-scene/scripts/GameManager';\r\nimport { GameModule } from '../../start-scene/scripts/GameModule';\r\nimport { Utils } from '../../start-scene/scripts/Utils';\r\nimport { BundleName, SetItemNumEnum, RewardIdEnum } from '../../start-scene/scripts/Constants';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass RecordShare extends GameModule {\r\n    @property(cc.Sprite)\r\n    private bg_spr: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    private count_lbl: cc.Label = null;\r\n\r\n    @property(cc.Button)\r\n    private close_btn: cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    private share_record_btn: cc.Button = null;\r\n\r\n    private _reward_data: { value: number } = null;\r\n\r\n    protected onEnable(): void {\r\n        this._reward_data = gm.data.record_data.push_share_reward_data;\r\n        this.count_lbl.string = \"+\" + this._reward_data.value;\r\n        this.share_record_btn.node.active = gm.data.record_data.left_push_share_count > 0;\r\n        Utils.async_set_sprite_frame(this.bg_spr, BundleName.RECORD, \"res/\" + Utils.math_random(true, 1, 5));\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.data.record_data.record_state = 0;\r\n        gm.data.record_data.record_timestamp = 0;\r\n        gm.data.event_emitter.emit(RecordData.RECORD_STATE_CHANGE);\r\n        gm.data.record_data.async_write_data();\r\n    }\r\n\r\n    private editor_on_button_click_handler(event: cc.Event): void {\r\n        if (event.target == this.close_btn.node) {\r\n            gm.ui.async_hide_module(gm.const.RecordShare);\r\n        } else if (event.target == this.share_record_btn.node) {\r\n            if (0 < gm.data.record_data.left_push_share_count) {\r\n                gm.channel.viedo_share(true, (result: number) => {\r\n                    if (this._reward_data && 0 == result) {\r\n                        gm.ui.async_hide_module(gm.const.RecordShare);\r\n                        gm.data.record_data.left_push_share_count--\r\n                        gm.data.record_data.share_record_count++;\r\n                        gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.ADD_ITEM_TYPE, this._reward_data.value);\r\n                        gm.ui.show_coin_fly(RewardIdEnum.DIAMOND, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n                    }\r\n                });\r\n            } else {\r\n                gm.ui.show_notice(\"Số lần chia sẻ đã hết, hãy quay lại vào ngày mai!!\");\r\n            }\r\n        }\r\n    }\r\n}"]}