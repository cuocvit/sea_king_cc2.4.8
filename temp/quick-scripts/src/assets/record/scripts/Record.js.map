{"version":3,"sources":["assets\\record\\scripts\\Record.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { BANNER_AD_TYPE } from '../../start-scene/scripts/ChannelManager';\r\nimport { SetItemNumEnum, RewardIdEnum } from '../../start-scene/scripts/Constants';\r\nimport { gm } from '../../start-scene/scripts/GameManager';\r\nimport { GameModule } from '../../start-scene/scripts/GameModule';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass Record extends GameModule {\r\n    @property(cc.Label)\r\n    private count_lbl: cc.Label = null;\r\n\r\n    @property(cc.Button)\r\n    private close_btn: cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    private record_btn: cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    private share_record_btn: cc.Button = null;\r\n\r\n    private _reward_data: { value: number };\r\n\r\n    protected onEnable(): void {\r\n        gm.channel.show_banner_ad(BANNER_AD_TYPE.ALL);\r\n        if (gm.data.record_data.share_record_count < gm.data.record_data.reward_array.length) {\r\n            this._reward_data = gm.data.record_data.reward_array[gm.data.record_data.share_record_count];\r\n        } else {\r\n            this._reward_data = gm.data.record_data.reward_data;\r\n        }\r\n\r\n        if (5 <= gm.data.record_data.share_record_count) {\r\n            this._reward_data.value = 0;\r\n        }\r\n\r\n        this.count_lbl.string = \"+\" + this._reward_data.value;\r\n        this.record_btn.node.active = 0 == gm.data.record_data.record_state;\r\n        this.share_record_btn.node.active = 2 == gm.data.record_data.record_state;\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.channel.hide_banner_ad(BANNER_AD_TYPE.ALL);\r\n        if (1 == gm.data.record_data.record_type && 2 == gm.data.record_data.record_state) {\r\n            gm.data.record_data.record_state = 0;\r\n            gm.data.record_data.record_timestamp = 0;\r\n            gm.data.event_emitter.emit(i.RecordData.RECORD_STATE_CHANGE);\r\n            gm.data.record_data.async_write_data();\r\n        }\r\n    }\r\n\r\n    private editor_on_button_click_handler(event: cc.Event): void {\r\n        if (event.target == this.close_btn.node) {\r\n            gm.ui.async_hide_module(gm.const.Record);\r\n\r\n        } else if (event.target == this.record_btn.node) {\r\n            gm.channel.record_start();\r\n            gm.data.record_data.record_state = 1;\r\n            gm.data.record_data.record_type = 1;\r\n            gm.data.record_data.record_timestamp = Date.now();\r\n            gm.data.event_emitter.emit(i.RecordData.RECORD_STATE_CHANGE);\r\n            gm.ui.async_hide_module(gm.const.Record);\r\n\r\n        } else if (event.target == this.share_record_btn.node) {\r\n            gm.channel.viedo_share(true, (result: number) => {\r\n                if (this._reward_data && 0 == result) {\r\n                    gm.ui.async_hide_module(gm.const.Record);\r\n                    gm.data.record_data.share_record_count++;\r\n                    gm.data.record_data.record_state = 0;\r\n                    gm.data.record_data.record_timestamp = 0;\r\n                    gm.data.event_emitter.emit(i.RecordData.RECORD_STATE_CHANGE);\r\n                    gm.data.record_data.async_write_data();\r\n                    gm.data.mapCell_data.setAddGameCoin(SetItemNumEnum.ADD_ITEM_TYPE, this._reward_data.value);\r\n                    gm.ui.show_coin_fly(RewardIdEnum.GOLD, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n"]}