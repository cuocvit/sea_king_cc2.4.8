{"version":3,"sources":["assets\\buildFunction\\scripts\\BarracksItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { HeroConfig } from '../../common/configs/hero';\r\nimport { StarConfig } from '../../common/configs/star';\r\nimport { BundleName } from '../../start-scene/scripts/Constants';\r\nimport { gm } from '../../start-scene/scripts/GameManager';\r\nimport { Utils } from '../../start-scene/scripts/Utils';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class BarracksItem extends cc.Component {\r\n    @property(cc.Node)\r\n    private shade_node: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private lock_node: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    private unlock_level_lbl: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    private unlock_node: cc.Node = null;\r\n\r\n    @property(cc.Sprite)\r\n    private hero_sprite: cc.Sprite = null;\r\n\r\n    @property(cc.Sprite)\r\n    private left_item_sprite: cc.Sprite = null;\r\n\r\n    @property(cc.Sprite)\r\n    private right_item_sprite: cc.Sprite = null;\r\n\r\n    @property(cc.Sprite)\r\n    private hero_color_sprite: cc.Sprite = null;\r\n\r\n    @property(cc.Sprite)\r\n    private hero_profession_sprite: cc.Sprite = null;\r\n\r\n    @property(cc.Sprite)\r\n    private hero_profession2_sprite: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    private hero_name_lbl: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    private heroStarNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private heroAtrrNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private upstarNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private btnUpstarNode: cc.Node = null;\r\n\r\n    @property(cc.Sprite)\r\n    private needHeroIcon: cc.Sprite = null;\r\n\r\n    @property(cc.Sprite)\r\n    private needHeroIconBg: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    private needLbl: cc.Label = null;\r\n\r\n    @property([cc.SpriteFrame])\r\n    private sprList: cc.SpriteFrame[] = [];\r\n\r\n    private _data: HeroConfig;\r\n    private _isCenter: boolean;\r\n    private _curIndex: number;\r\n\r\n    private constructor() {\r\n        super();\r\n        this._data = null;\r\n        this._isCenter = false;\r\n        this._curIndex = 0;\r\n    }\r\n\r\n    public update_view(heroId: number, isCenter: boolean, curIndex: number): void {\r\n        if (gm.data.mapCell_data.barracks_unlock_data[curIndex].ani_state === 0 &&\r\n            gm.data.mapCell_data.barracks_unlock_data[curIndex].state === 1\r\n        ) {\r\n            gm.data.mapCell_data.barracks_unlock_data[curIndex].ani_state = 1;\r\n            gm.data.mapCell_data.async_write_data();\r\n            this.node.getComponent(cc.Animation).play();\r\n        }\r\n        this._isCenter = isCenter;\r\n        this._curIndex = curIndex;\r\n        const heroData = gm.config.get_row_data(\"HeroConfigData\", heroId.toString()) as HeroConfig;\r\n        if (!heroData) return;\r\n        this._data = heroData;\r\n        Utils.async_set_sprite_frame(this.left_item_sprite, BundleName.COMMON, \"res/heroCircleImg/\" + heroData.itemType[0]);\r\n        Utils.async_set_sprite_frame(this.right_item_sprite, BundleName.MAP, \"res/\" + heroData.itemType[1]);\r\n        this.hero_name_lbl.string = heroData.name;\r\n        Utils.async_set_sprite_frame(this.hero_color_sprite, BundleName.COMMON, \"res/circleColor_\" + heroData.color);\r\n        Utils.async_set_sprite_frame(this.hero_sprite, BundleName.COMMON, \"res/heroCircleImg/\" + heroData.heroid);\r\n        this.shade_node.active = isCenter;\r\n\r\n        if (heroData.occupation <= 6) {\r\n            this.hero_profession_sprite.node.active = true;\r\n            if (heroData.occupation > 3) {\r\n                this.hero_profession2_sprite.node.active = true;\r\n                Utils.async_set_sprite_frame(this.hero_profession_sprite, BundleName.BUILD_FUNCTION, \"res/1\");\r\n                Utils.async_set_sprite_frame(this.hero_profession2_sprite, BundleName.BUILD_FUNCTION, \"res/2\");\r\n            } else {\r\n                Utils.async_set_sprite_frame(this.hero_profession_sprite, BundleName.BUILD_FUNCTION, \"res/\" + heroData.occupation);\r\n                this.hero_profession2_sprite.node.active = false;\r\n            }\r\n        } else {\r\n            this.hero_profession_sprite.node.active = false;\r\n            this.hero_profession2_sprite.node.active = false;\r\n        }\r\n\r\n        Utils.set_sprite_state(this.left_item_sprite.node, cc.Sprite.State.NORMAL);\r\n        Utils.set_sprite_state(this.right_item_sprite.node, cc.Sprite.State.NORMAL);\r\n\r\n        if (gm.data.mapCell_data.barracks_unlock_data[this._curIndex].state <= 0) {\r\n            this.lock_node.active = true;\r\n            this.unlock_node.active = false;\r\n            this.unlock_level_lbl.node.active = true;\r\n            this.unlock_level_lbl.string = \"LEVEL \" + heroData.barracks;\r\n            Utils.set_sprite_state(this.hero_color_sprite.node, cc.Sprite.State.GRAY);\r\n            Utils.set_sprite_state(this.left_item_sprite.node, cc.Sprite.State.GRAY);\r\n            Utils.set_sprite_state(this.right_item_sprite.node, cc.Sprite.State.GRAY);\r\n        } else {\r\n            Utils.set_sprite_state(this.hero_color_sprite.node, cc.Sprite.State.NORMAL);\r\n            this.lock_node.active = false;\r\n            this.unlock_node.active = true;\r\n            this.upstarNode.active = false;\r\n            const heroStarData = gm.data.hero_star_data.getHeroStarData(heroData.arms);\r\n            if (heroStarData) {\r\n                this.upstarNode.active = true;\r\n                const nextHeroData = gm.config.get_row_data(\"HeroConfigData\", heroStarData.nextNeedItem.toString()) as HeroConfig;\r\n                if (nextHeroData) {\r\n                    Utils.async_set_sprite_frame(this.needHeroIconBg, BundleName.COMMON, \"res/circleColor_\" + nextHeroData.color);\r\n                    Utils.async_set_sprite_frame(this.needHeroIcon, BundleName.COMMON, \"res/heroCircleImg/\" + nextHeroData.icon);\r\n                }\r\n                for (let r = 0; r < this.heroStarNode.childrenCount; r++) {\r\n                    this.heroStarNode.children[r].getComponent(cc.Sprite).spriteFrame = heroStarData.star > r ? this.sprList[0] : this.sprList[1];\r\n                }\r\n                const starHeroNum = gm.data.mapCell_data.getStarHeroNumByID(heroStarData.nextNeedItem);\r\n                this.needLbl.string = starHeroNum + \"/\" + heroStarData.nextNeedNum;\r\n                this.needLbl.node.color = starHeroNum >= heroStarData.nextNeedNum ? cc.Color.GREEN : cc.Color.RED;\r\n\r\n                const attributeKeys = [\"Perk_HP\", \"Perk_Attackers\", \"Perk_Defense\", \"Perk_Time\"];\r\n                const attributeNames = [\"Sinh mạng\", \"Tấn công\", \"Phòng thủ\", \"Tốc độ\"];\r\n                const currentAttributes = [\r\n                    100 * heroStarData.hp,\r\n                    100 * heroStarData.attack,\r\n                    heroStarData.defense,\r\n                    heroStarData.speed\r\n                ];\r\n\r\n                let upgradedAttributes = currentAttributes;\r\n\r\n                this.btnUpstarNode.active = heroStarData.nextNeedItem > 0 && heroStarData.nextNeedNum > 0;\r\n                if (this.btnUpstarNode.active) {\r\n                    const nextStarData = gm.config.get_row_data(\"StarConfigData\", heroStarData.arms.toString(), (heroStarData.star + 1).toString()) as StarConfig;\r\n                    if (nextStarData) {\r\n                        upgradedAttributes = [100 * nextStarData.hp, 100 * nextStarData.attack, nextStarData.defense, nextStarData.speed];\r\n                    }\r\n                }\r\n                for (let r = 0; r < this.heroAtrrNode.childrenCount; r++) {\r\n                    const attrNode = this.heroAtrrNode.children[r];\r\n                    if (r != 3) {\r\n                        Utils.async_set_sprite_frame(attrNode.children[0].getComponent(cc.Sprite), BundleName.COMMON, \"res/attrIcon/\" + attributeKeys[r]);\r\n                        attrNode.children[1].getComponent(cc.Label).string = attributeNames[r];\r\n                        attrNode.children[2].getComponent(cc.Label).string = upgradedAttributes[r] + \"%\";\r\n                        attrNode.children[3].active = currentAttributes[r] < upgradedAttributes[r];\r\n                    } else {\r\n                        attrNode.active = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private onClickUpgrade(): void {\r\n        const heroStarData = gm.data.hero_star_data.getHeroStarData(this._data.arms);\r\n        if (!heroStarData) return;\r\n        if (gm.data.mapCell_data.getStarHeroNumByID(heroStarData.nextNeedItem) < heroStarData.nextNeedNum) {\r\n            gm.ui.show_notice(\"Không đủ anh hùng!!!\");\r\n        } else {\r\n            gm.data.mapCell_data.delStarHeroNumByID(heroStarData.nextNeedItem, heroStarData.nextNeedNum);\r\n            gm.data.hero_star_data.upgradeHeroStar(this._data.arms);\r\n            this.update_view(this._data.heroid, this._isCenter, this._curIndex);\r\n        }\r\n    }\r\n\r\n    private onClickBook(): void {\r\n        gm.ui.set_module_args(gm.const.BOOK_HERO_DETAIL.key, [this._data.heroid]);\r\n        gm.ui.show_panel(gm.const.BOOK_HERO_DETAIL);\r\n    }\r\n}"]}