{"version":3,"sources":["assets\\add_desktop\\scripts\\AddDesktop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { gm } from '../../start-scene/scripts/GameManager';\r\nimport { GameModule } from '../../start-scene/scripts/GameModule';\r\nimport { NodePoolItem } from '../../start-scene/scripts/NodePoolItem';\r\nimport { ReportData } from '../../start-scene/scripts/NetUtils';\r\nimport { BundleName } from '../../start-scene/scripts/Constants';\r\nimport { HeroConfig } from '../../common/configs/hero';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass AddDesktop extends GameModule {\r\n    @property(cc.Button)\r\n    private close_btn: cc.Button = null;\r\n\r\n    @property(cc.Button)\r\n    private add_desktop_btn: cc.Button = null;\r\n\r\n    @property(cc.Node)\r\n    private left_node: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private right_node: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    private left_lbl: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    private right_lbl: cc.Label = null;\r\n\r\n    protected onEnable(): void {\r\n        const self = this;\r\n        if (this.left_node.childrenCount === 0) {\r\n            gm.pool.async_get(BundleName.COMMON, \"prefabs/model/\" + gm.const.ADD_DESKTOP_REWARD_LEFT_HERO_ID, NodePoolItem, (item) => {\r\n                if (self.left_node.childrenCount === 0) {\r\n                    self.left_node.addChild(item.node);\r\n                } else {\r\n                    gm.pool.put(item.node);\r\n                }\r\n            });\r\n        }\r\n        const leftHeroData = gm.config.get_row_data(\"HeroConfigData\", gm.const.ADD_DESKTOP_REWARD_LEFT_HERO_ID + \"\") as HeroConfig;\r\n        if (leftHeroData) this.left_lbl.string = leftHeroData.name;\r\n\r\n        if (this.right_node.childrenCount === 0) {\r\n            gm.pool.async_get(BundleName.COMMON, \"prefabs/model/\" + gm.const.ADD_DESKTOP_REWARD_RIGHT_HERO_ID, NodePoolItem, (item) => {\r\n                if (self.right_node.childrenCount === 0) {\r\n                    self.right_node.addChild(item.node);\r\n                } else {\r\n                    gm.pool.put(item.node);\r\n                }\r\n            });\r\n        }\r\n        const rightHeroData = gm.config.get_row_data(\"HeroConfigData\", gm.const.ADD_DESKTOP_REWARD_RIGHT_HERO_ID + \"\") as HeroConfig;\r\n        if (rightHeroData) this.right_lbl.string = rightHeroData.name;\r\n\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        gm.pool.put_children(this.left_node);\r\n        gm.pool.put_children(this.right_node);\r\n    }\r\n\r\n    protected editor_on_button_click_handler(event: cc.Event): void {\r\n        if (event.target == this.close_btn.node) {\r\n            gm.ui.async_hide_module(gm.const.AddDesktop);\r\n        } else if (event.target == this.add_desktop_btn.node) {\r\n            gm.channel.addShortcut(() => {\r\n                if (gm.data.main_data.is_receive_shortcut_reward) {\r\n                    gm.ui.show_notice(\"Đã nhận được phần thưởng thêm vào máy tính để bàn!\");\r\n                    gm.ui.async_hide_module(gm.const.AddDesktop);\r\n                } else {\r\n                    gm.data.main_data.is_receive_shortcut_reward = true;\r\n                    gm.data.main_data.async_write_data();\r\n                    gm.data.mapCell_data.addWareHouseList([gm.const.ADD_DESKTOP_REWARD_LEFT_HERO_ID, gm.const.ADD_DESKTOP_REWARD_RIGHT_HERO_ID]);\r\n                    gm.data.mapCell_data.async_write_data();\r\n                    gm.ui.set_module_args(gm.const.GETREWARDOP.key, {\r\n                        idList: [gm.const.ADD_DESKTOP_REWARD_LEFT_HERO_ID, gm.const.ADD_DESKTOP_REWARD_RIGHT_HERO_ID],\r\n                        numList: [1, 1]\r\n                    });\r\n                    gm.ui.async_show_module(gm.const.GETREWARDOP);\r\n                    gm.ui.async_hide_module(gm.const.AddDesktop);\r\n                    ReportData.instance.report_once_point(10639);\r\n                }\r\n            });\r\n        }\r\n    }\r\n}"]}