{"version":3,"sources":["assets\\buy\\scripts\\buyItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { NodePoolItem } from \"../../start-scene/scripts/NodePoolItem\";\r\nimport { Utils } from \"../../start-scene/scripts/Utils\";\r\nimport { ReportData } from \"../../start-scene/scripts/NetUtils\";\r\nimport { gm } from \"../../start-scene/scripts/GameManager\";\r\nimport {\r\n    BundleName,\r\n    SetItemNumEnum,\r\n} from \"../../start-scene/scripts/Constants\";\r\nimport { SignBuyItemData } from \"../../start-scene/scripts/SignData\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class BuyItem extends NodePoolItem {\r\n    @property(cc.Sprite)\r\n    private color_spr: cc.Sprite | null = null;\r\n\r\n    @property(cc.Sprite)\r\n    private hero_spr: cc.Sprite | null = null;\r\n\r\n    @property(cc.Label)\r\n    private money_lbl: cc.Label | null = null;\r\n\r\n    @property(cc.Button)\r\n    private receive_btn: cc.Button | null = null;\r\n\r\n    private _data: SignBuyItemData;\r\n\r\n    public get data(): SignBuyItemData {\r\n        return this._data;\r\n    }\r\n\r\n    public set data(value: SignBuyItemData) {\r\n        this._data = value;\r\n        this.update_view();\r\n    }\r\n\r\n    private update_view(): void {\r\n        const data = this._data;\r\n        this.money_lbl.string =\r\n            data.reward_data.money > 0\r\n                ? data.reward_data.money.toString()\r\n                : \"Miễn Phí\";\r\n        this.receive_btn.node.active = data.state > 0;\r\n        this.receive_btn.interactable = data.state === 1;\r\n        Utils.set_sprite_state(\r\n            this.receive_btn.node,\r\n            data.state === 2 ? cc.Sprite.State.GRAY : cc.Sprite.State.NORMAL\r\n        );\r\n        Utils.async_set_sprite_frame(\r\n            this.hero_spr,\r\n            BundleName.COMMON,\r\n            \"res/heroCircleImg/\" + data.reward_data.reward_id\r\n        );\r\n    }\r\n\r\n    public reset(): void {\r\n        this.color_spr.spriteFrame = null;\r\n        this.hero_spr.spriteFrame = null;\r\n    }\r\n\r\n    public editor_on_button_click_handler(event: cc.Event): void {\r\n        if (event.target === this.receive_btn.node) {\r\n            const data = this._data;\r\n            if (\r\n                gm.data.mapCell_data.roleCoinData.diamondNum <\r\n                data.reward_data.money\r\n            ) {\r\n                gm.ui.set_module_args(gm.const.GETCOINOP.key, true);\r\n                gm.ui.show_panel(gm.const.GETCOINOP);\r\n                return;\r\n            }\r\n            if (data.reward_data.money > 0) {\r\n                ReportData.instance.report_once_point(10835);\r\n            }\r\n            data.state = 2;\r\n            gm.data.mapCell_data.setAddGameDiamond(\r\n                SetItemNumEnum.REDUCE_ITEM_TYPE,\r\n                data.reward_data.money\r\n            );\r\n            const rewardIds: number[] = [];\r\n            for (let i = 0; i < data.reward_data.reward_num; i++) {\r\n                rewardIds.push(data.reward_data.reward_id);\r\n            }\r\n            gm.ui.set_module_args(gm.const.GETREWARDOP.key, {\r\n                idList: [data.reward_data.reward_id],\r\n                numList: [data.reward_data.reward_num],\r\n            });\r\n            gm.ui.async_show_module(gm.const.GETREWARDOP);\r\n            gm.data.mapCell_data.addWareHouseList(rewardIds);\r\n            gm.data.mapCell_data.async_write_data();\r\n            gm.data.sign_data.async_write_data();\r\n        }\r\n    }\r\n}\r\n"]}