{"version":3,"sources":["assets\\store\\scripts\\RMBStoreItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// file này không duodcj import ở đâu\r\nimport { NodePoolItem } from '../../start-scene/scripts/NodePoolItem';\r\nimport { Utils } from '../../start-scene/scripts/Utils';\r\nimport { BundleName, RewardIdEnum, SetItemNumEnum } from '../../start-scene/scripts/Constants';\r\nimport { gm } from '../../start-scene/scripts/GameManager';\r\nimport { MallConfig } from '../../common/configs/mall';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nclass RMBStoreItem extends NodePoolItem {\r\n    @property(cc.Sprite)\r\n   private rewardSpr: cc.Sprite = null;\r\n\r\n    @property(cc.Node)\r\n    private rewardNode1: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private rewardNode2: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private  btnDiam: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private  btnAd: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private btnRMB: cc.Node = null;\r\n\r\n    private _data: MallConfig;\r\n\r\n  public  get data(): MallConfig {\r\n        return this._data;\r\n    }\r\n\r\n  public  set data(value: MallConfig) {\r\n        this._data = value;\r\n        this.update_view();\r\n    }\r\n\r\n    private update_view(): void {\r\n        const itemData = this._data;\r\n        Utils.async_set_sprite_frame(this.rewardSpr, BundleName.STORE, \"res/\" + itemData.show_img);\r\n        this.rewardSpr.node.x = -16;\r\n        Utils.async_set_sprite_frame(this.rewardNode1.getComponent(cc.Sprite), BundleName.MAP, \"res/\" + itemData.item_id);\r\n        this.rewardNode1.children[0].getComponent(cc.Label).string = itemData.item_num + \"\";\r\n        this.rewardNode2.active = 0 < itemData.item_id1;\r\n\r\n        if (this.rewardNode2.active) {\r\n            Utils.async_set_sprite_frame(this.rewardNode2.getComponent(cc.Sprite), BundleName.MAP, \"res/\" + itemData.item_id1);\r\n            this.rewardNode1.children[0].getComponent(cc.Label).string = itemData.item_num1 + \"\";\r\n            this.rewardSpr.node.x = 73;\r\n        }\r\n\r\n        this.btnRMB.active = 1 == this.data.money_type;\r\n        this.btnRMB.children[0].getComponent(cc.Label).string = \"￥\" + itemData.price;\r\n        this.btnDiam.active = 1 != this.data.money_type && 2 != this.data.money_type;\r\n        this.btnDiam.children[0].getComponent(cc.Label).string = \"\" + itemData.price;\r\n        this.btnAd.active = 2 == this.data.money_type;\r\n    }\r\n\r\n    private onClickRmb(): void {\r\n        this.get_reward();\r\n    }\r\n\r\n    private get_reward(): void {\r\n        const itemIds = [this.data.item_id, this.data.item_id1];\r\n        const itemNums = [this.data.item_num, this.data.item_num1];\r\n\r\n        for (let index = 0; index < itemIds.length; index++) {\r\n            if (!(itemIds[index] <= 0)) {\r\n                if (11006 == itemIds[index]) {\r\n                    gm.data.mapCell_data.addBarrelNum(itemNums[index]);\r\n                    gm.ui.show_coin_fly(RewardIdEnum.BARREL, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO));\r\n                } else if (11003 == itemIds[index]) {\r\n                    gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.ADD_ITEM_TYPE, itemNums[index]);\r\n                    gm.ui.show_coin_fly(RewardIdEnum.DIAMOND, this.node.convertToWorldSpaceAR(cc.Vec3.ZERO))\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private onClickAd(): void {\r\n        gm.channel.show_video_ad(this.get_reward.bind(this));\r\n    }\r\n\r\n    private onClickDiam(): void {\r\n        if (gm.data.mapCell_data.roleCoinData.diamondNum < this.data.price) {\r\n            gm.ui.set_module_args(gm.const.GETCOINOP.key, true);\r\n            gm.ui.async_show_module(gm.const.GETCOINOP);\r\n            return;\r\n        }\r\n\r\n        gm.data.mapCell_data.setAddGameDiamond(SetItemNumEnum.REDUCE_ITEM_TYPE, this.data.price);\r\n        this.get_reward();\r\n    }\r\n}\r\n\r\nexport default RMBStoreItem;"]}