{"version":3,"sources":["assets\\book\\scripts\\SceneBookView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameModule } from '../../start-scene/scripts/GameModule';\r\nimport { BundleName } from '../../start-scene/scripts/Constants';\r\nimport { gm } from '../../start-scene/scripts/GameManager';\r\nimport NodeBookFormula from './NodeBookFormula';\r\nimport NodeBookItem from './NodeBookItem';\r\nimport SceneBookLogic from './SceneBookLogic';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class SceneBookView extends GameModule {\r\n    @property(cc.Node)\r\n    private node_tabs: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private panel_hero: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private panel_item: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private panel_decorate: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private panel_formula: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_super_heros: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_heros: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_defends: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_Walls: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_normals: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_specials: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_ress: cc.Node | null;\r\n\r\n    @property(cc.Node)\r\n    private list_decorates: cc.Node | null;\r\n\r\n    @property([cc.Node])\r\n    private list_lvs: cc.Node[];\r\n\r\n\r\n    private tBookItems: NodeBookItem[];\r\n    private tBookFormulas: NodeBookFormula[];\r\n    private tTabPanels: { [key: string]: cc.Node | null } | null;\r\n    private iFormulaListBeginCd: number;\r\n    private pLogic: SceneBookLogic;\r\n\r\n    constructor() {\r\n        super();\r\n        this.pLogic = new SceneBookLogic();\r\n        this.node_tabs = null;\r\n        this.panel_hero = null;\r\n        this.panel_item = null;\r\n        this.panel_decorate = null;\r\n        this.panel_formula = null;\r\n        this.list_super_heros = null;\r\n        this.list_heros = null;\r\n        this.list_defends = null;\r\n        this.list_Walls = null;\r\n        this.list_normals = null;\r\n        this.list_specials = null;\r\n        this.list_ress = null;\r\n        this.list_decorates = null;\r\n        this.list_lvs = [];\r\n        this.tBookItems = [];\r\n        this.tBookFormulas = [];\r\n        this.tTabPanels = null;\r\n        this.iFormulaListBeginCd = 0;\r\n        this.sceneBindLogic(this, this.pLogic);\r\n    }\r\n\r\n    protected onLoad(): void { }\r\n\r\n    protected onEnable(): void {\r\n        this.tTabPanels = {\r\n            btn_hero: this.panel_hero,\r\n            btn_item: this.panel_item,\r\n            btn_decorate: this.panel_decorate,\r\n            btn_formula: this.panel_formula,\r\n        };\r\n    }\r\n\r\n    public getLogic(): SceneBookLogic {\r\n        return this.pLogic;\r\n    }\r\n\r\n    public showTabPanel(tab: string): void {\r\n        if (this.tTabPanels == null) {\r\n            this.tTabPanels = {\r\n                btn_hero: this.panel_hero,\r\n                btn_item: this.panel_item,\r\n                btn_decorate: this.panel_decorate,\r\n                btn_formula: this.panel_formula,\r\n            };\r\n        }\r\n        for (const key in this.tTabPanels) {\r\n            this.tTabPanels[key].active = key == tab;\r\n        }\r\n    }\r\n\r\n    protected onDisable(): void { }\r\n\r\n    public refreshSelectTabBtn(tab: string): void {\r\n        const children = this.node_tabs.children;\r\n        for (let i = 0; i < children.length; i++) {\r\n            const child = children[i];\r\n            child.active = child.name.endsWith('_active') ? `${tab}_active` == child.name : tab !== child.name;\r\n        }\r\n    }\r\n\r\n    public refreshRed(prefix: string, active: boolean): void {\r\n        const children = this.node_tabs.children;\r\n        let count = 0;\r\n        for (let i = 0; i < children.length; i++) {\r\n            const child = children[i];\r\n            if (child.name.startsWith(prefix)) {\r\n                child.getChildByName('red').active = active;\r\n                if (++count >= 2) break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public initDefendList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_defends);\r\n    }\r\n\r\n    public initSuperHeroList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_super_heros);\r\n    }\r\n\r\n    public initHeroList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_heros);\r\n    }\r\n\r\n    public initWallList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_Walls);\r\n    }\r\n\r\n    public initNormalList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_normals);\r\n    }\r\n\r\n    public initSpecialList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_specials);\r\n    }\r\n\r\n    public initResList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_ress);\r\n    }\r\n\r\n    public initDecorateList(items: number[]): void {\r\n        this.addBookItemsToList(items, this.list_decorates);\r\n    }\r\n\r\n    private addBookItemsToList(items: number[], list: cc.Node): void {\r\n        const formattedList = this.formatList(items);\r\n        for (let index = 0; index < formattedList.length; index++) {\r\n            this.loadBookItem((item) => {\r\n                item.node.zIndex = index;\r\n                list.addChild(item.node);\r\n                this.tBookItems.push(item);\r\n                item.reset();\r\n                item.init(formattedList[index], true);\r\n            });\r\n        }\r\n    }\r\n\r\n    public initFormulaList(formulas: Record<string, number[]>): void {\r\n        this.iFormulaListBeginCd = 0;\r\n        for (let i = 0; i < this.list_lvs.length; i++) {\r\n            const levelNode = this.list_lvs[i];\r\n            const formulaItems = formulas[i];\r\n            if (formulaItems != null) {\r\n                for (let j = 0; j < formulaItems.length; j++) {\r\n                    const formula = formulaItems[j];\r\n                    this.loadFormulaItem((item) => {\r\n                        levelNode.addChild(item.node);\r\n                        this.iFormulaListBeginCd += 0.1;\r\n                        item.init(formula, this.iFormulaListBeginCd);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private formatList(items: number[]): number[] {\r\n        const length = items.length;\r\n        if (length % 3 <= 0) {\r\n            return items;\r\n        }\r\n\r\n        const formatted: number[] = [];\r\n        for (let index = 0; index < items.length; index++) {\r\n            formatted.push(items[index]);\r\n        }\r\n\r\n        const toAdd = 3 - length % 3;\r\n        for (let index = 0; index < toAdd; index++) {\r\n            formatted.push(0);\r\n        }\r\n        return formatted;\r\n    }\r\n\r\n    private loadBookItem(callback: (item: NodeBookItem) => void): void {\r\n        gm.pool.async_get(BundleName.BOOK, 'prefabs/book_item', NodeBookItem, (item) => {\r\n            item.reset();\r\n            this.tBookItems.push(item);\r\n            callback(item);\r\n        });\r\n    }\r\n\r\n    private loadFormulaItem(callback: (item: NodeBookFormula) => void): void {\r\n        gm.pool.async_get(BundleName.BOOK, 'prefabs/book_formula', NodeBookFormula, (item) => {\r\n            item.reset();\r\n            this.tBookFormulas.push(item);\r\n            callback(item);\r\n        });\r\n    }\r\n\r\n    public recyleBookItems(): void {\r\n        for (let i = 0; i < this.tBookItems.length; i++) {\r\n            this.tBookItems[i].reset();\r\n            gm.pool.put(this.tBookItems[i].node);\r\n        }\r\n        this.tBookItems = [];\r\n        for (let i = 0; i < this.tBookFormulas.length; i++) {\r\n            this.tBookFormulas[i].reset();\r\n            gm.pool.put(this.tBookFormulas[i].node);\r\n        }\r\n        this.tBookFormulas = [];\r\n    }\r\n\r\n    private editor_on_button_click_handler(event: cc.Event, data: cc.Event): void {\r\n        const targetName = event.target.name;\r\n        this.pLogic.onBtnClick(targetName, data === undefined ? null : data);\r\n    }\r\n\r\n    private sceneBindLogic(instance: SceneBookView, logic: SceneBookLogic): void { \r\n        const bindMethod = (methodName: string) => {\r\n            const originalMethod = instance[methodName];\r\n            if (null != originalMethod) {\r\n                instance[methodName] = (t) => {\r\n                    if (null != logic[methodName]) {\r\n                        logic[methodName].apply(logic, [t]);\r\n                    }\r\n                    originalMethod.apply(instance, [t]);\r\n                };\r\n            }\r\n        }\r\n        logic.setView(instance);\r\n        bindMethod(\"onLoad\");\r\n        bindMethod(\"onEnable\");\r\n        bindMethod(\"onDisable\");\r\n    }\r\n}"]}